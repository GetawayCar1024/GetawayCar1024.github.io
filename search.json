[{"title":"2025 年日祭","url":"/2025/2025-年日祭/","content":"\n本文将同步发表于[洛谷（暂无法访问）](https://www.luogu.com.cn/article/4njz96qw)、[CSDN](https://blog.csdn.net/qq_43546083/article/details/145521343) 与 [Github 个人博客](https://getawaycar1024.github.io/2025/2025-%E5%B9%B4%E6%97%A5%E7%A5%AD/)。\n\n本蒟自2025.2.8开始半停课。\n\n---\n\n以下是题目格式：\n\n- [[题目OJ 题号] [来源（选填）] 名称](链接)\n\n  ……\n\n- 题号 - 名称\n\n  题目：……\n\n  题解：……\n\n- 题号 - 名称 （[[题目OJ 题号] [来源（选填）] 名称](链接)）\n\n  ……\n\n---\n\n### 任务计划（站外题与专题）\n\n（2025.2.8）\n\n- [ ] [Network](https://vjudge.net/problem/POJ-3694#author=GPT_zh)\n\n- [ ] [Network of Schools](https://vjudge.net/problem/POJ-1236#author=GPT_zh)\n\n- [ ] [DP优化——矩阵](https://vjudge.net/contest/679550)\n\n- [ ] [数论——容斥、二项式反演](https://vjudge.net/contest/681523)\n\n- [ ] [DP优化——斜率优化](https://vjudge.net/contest/682437)\n\n- [ ] [数据结构——左偏树](https://vjudge.net/contest/682428)\n\n- [ ] [数据结构——吉司机线段树](https://vjudge.net/contest/684161)\n\n- [ ] [数据结构——李超线段树](https://vjudge.net/contest/685058)\n\n### 2025.1.4 新的一年\n\n今日歌曲：**New Year's Day**\n\n去年停课的时候是有记日祭的，但是有一些是手写的，一直都还没有整理好。今天看到一个简单的trick，想记下来。于是，就又开始写日祭了。\n\n- [[洛谷 P2831] [NOIP2016 提高组] 愤怒的小鸟](https://www.luogu.com.cn/problem/P2831)\n\n  一道远古状压题了。（一是指题目本身远古，二是指这道题是好久之前就该做的题。）看到第一篇题解的trick，想起去年暑假集训的时候也有这样一个trick，但是忘了是哪道题。这个trick挺简单的，但也挺好用：状压时，如果目标状态是全0或全1，并且转移顺序不影响结果，那么可以直接从最低位的1或0转移，因为最低位最终一定会被转移，而顺序又不影响结果，所以这样做可以优化掉 $O(n)$ 的复杂度。其他的按正常状压即可。\n\n- [[Atcoder ARC100E] Or Plus Max](https://www.luogu.com.cn/problem/AT_arc100_c)\n\n  今天学了sosdp，挺神奇的一种dp。这个题算是板子题吧。只用维护子集的最大值与次大值即可。\n\n今天下午给初二机房的办了一场比赛，整体比较顺利。（所以没做什么题。）比赛链接：[CWOI-N ER & NYR 1](https://www.luogu.com.cn/contest/222438)。\n\n今天感觉要掉橙了，但是Rated的比赛还要等一周。想着把之前那篇被打回的题解改了交了，但是晚上写给初二机房的的题解了，没空。看明天改吧。\n\n### 2025.1.10 新的开始\n\n今日歌曲：Castles Crumbling\n\n今天考完期末，回来一看，天塌了，掉橙了。明天打一场比赛。\n\n现在终于确定15班后续的各种事项了。又是一个**新的开始**。\n\n另外，我就莫名奇妙地进省选了（尽管是体验名额）。还有一个有趣的事实：\n\n> 我没有提高组一等奖，然而我进了NOIP（体验名额）；我没有NOIP一等奖，但我进了省选（体验名额）。\n\n期待人生中的第一场SCOI（希望不要爆零）。\n\n### 2025.1.12 言而无信\n\n今日歌曲：Back To December （好吧其实是存货）\n\n我果然是一个**言而无信**的人。踩一脚前天的日祭，昨天还是没打比赛。\n\n今天%你赛，除了暴力的B和C，其它全挂了分。至于A，调试的时候把模数写掉了。被暴扣70分呜呜呜。\n\n最终荣获 $30 + 10 + 30 + 0 = 70$ 的**高**分。\n\n- A - 括号序列\n\n  题目：给一个由左右括号构成的字符串 $s$，对于每一个位置 $i$，输出有多少个子串，满足这个子串是一个合法的括号序列，并且 $i$ 这个位置在子串中。\n\n  题解：简单维护前缀与后缀的括号数量即可。（忘写**该死的**模数暴扣70pts。）\n\n- C - 矩阵删除\n\n  题目：给一个 $n \\times m$ 的 01 矩阵，我们想在每一行删除一个元素，得到一个 $n \\times (m - 1)$ 的矩阵。其中删除的元素的位置 $(i, a_i)(1 \\le i \\le n)$，满足 $\\vert a_{i} - a_{i + 1} \\vert \\le k(1 \\le i \\lt n)$。请问最后能得到多少种不同的矩阵。两个矩阵如果删除的元素位置不同，但最后得到的结果相同，我们认为是相同的。由于答案很大，输出答案对 $10^9+7$ 取模的值。\n\n  题解：比较板的DP，但是赛时思路没那么清晰，也没去推式子。分别维护对于每一个位置的方案数以及与旁边位置重合的方案数，推出式子后发现全都是求和，于是用前缀和维护即可。\n\n### 2025.1.13 乐极生悲\n\n今日歌曲：Wonderland\n\n今天期末考试考完了，整体还行，语文更是考到了惊人的 $127.5$，要知道我之前最高的一次也就 $122$ 左右，而且还经常上不了 $120$，这次简直是超常发挥。听到成绩的时候直接喜极而泣了。\n\n下午体育课，刚好初一体锻放歌，放得全是霉霉的歌，我还去点了几首。开心。\n\n然而下课要集合的时候，我小跑了一下，而这下就恰好被足球爆头，眼镜镜架直接断掉，箍牙的铁丝直接断掉，嘴皮直接被铁钉磨得烂掉，鼻子被眼镜压了一个印子，还在流鼻血。\n\n真是**乐极生悲**。\n\n### 2025.1.17 傻子游戏\n\n今日歌曲：Foolish One\n\n今天开始上课六天。\n\n昨天听说 jmr 拿了清华一等约。祝贺他。\n\n这周二（1.14）已经回到15班了。\n\n昨天晚上玩梗发癫，还玩了离谱的**傻子游戏**。达成成就：在5.5h里睡够8h。\n\n上午%你赛，T1忘了判零挂了10pts，T3是之前做过的一道原题，于是赛时死磕，最后没调出来。赛时的思路基本上是对的，但是没想到容斥；又因为我钦定的一个条件有问题，导致正确性略有问题，最后没调出来。\n\n喜提 $90$ 分。\n\n- A - 串\n\n  题目：在虱子王国，一句话由 $n$ 个词组成，其中恰好有 $k$ 个词是怪的，其它的词都不是怪的。众所周知，负负得正，我们定义一句话的一个区间是怪的，当且仅当其中含有奇数个怪词。请构造一句符合条件的话，使得其中怪的区间数量最多。\n\n  题解：发现答案为奇数块乘上偶数块。构造即可。\n\n- B - 艺术家\n\n  题目：给定一个长度为 n 的颜色序列 $c$。再给出 $m$ 个区间，第 $i$ 个区间为 $[li, ri]$，**保证任何两个区间都是不相交或包含的关系**。在接下来的 $q$ 个单位时间内，第 $i$ 个时间会给定 $x, y$，表示将 $c_x$ 变为 $y$。请对于每一个区间求出，最早的其中所有颜色都互不相同的时间。\n\n  题解：\n\n  > **保证任何两个区间都是不相交或包含的关系。**\n\n  所以可以把区间建成一棵树。当一个子区间合法，其父区间才有可能合法。在原数轴上维护 $lst_i$ 表示 $i$ 之前第一个颜色与 $i$ 相同的点，则一个区间内部颜色互不相同等价于 $\\max\\{lst_i, l \\le i \\le r\\}$。使用线段树维护。对于 $lst$ 的更新，用 set 维护。**即可**。（难写死了，还没写完。）\n\n- C - 黑白树 （[[Atcoder ARC108F] Paint Tree](https://atcoder.jp/contests/arc108/tasks/arc108_f)）\n\n  题解：画一个直径上吊着节点的图，讨论一个节点在什么时候可以带来贡献。容斥计算即可。\n\n晚上打了入门赛，可以加咕值了。\n\n晚自习最后10分钟，记一些话。\n\n> 我的信竞，在进步么？看起来好像是的。要是拿现在的我和一年前的我对比，那已足以 $k$ 倍杀。但……补过的题还是不会做，码量大一点的又不愿意写，一到晚自习就写不动了，于是写一会儿又开始划水。我倒有一个优点，就是一般不会去刷水题（除了入门赛）。但是，难一些的题……绿题效率低，蓝题想不全于是又看题解，紫题几乎无法独立完成。\n>\n> 最终做了的题似乎是白做。\n>\n> ……\n> \n> 终究还是人的问题。\n\n### 2025.1.18 正难则反\n\n今日歌曲：Wildest Dream\n\n这两天换了头像。\n\n今天上午VP [CodeForces Round 997 (Div. 2)](https://codeforces.com/contest/2056)。\n\n- [[CodeForces 2056A] Shape Perimeter](https://codeforces.com/contest/2056/problem/A)\n\n  计算重叠部分即可。\n\n- [[CodeForces 2056B] Find the Permutation](https://codeforces.com/contest/2056/problem/B)\n\n  我们总是建从小节点到大节点的**有向**边，对这个DAG进行拓扑排序。因为我们有时并不想让一个小节点往大节点连边，所以用堆维护入度为零的点即可。（可恶，赛时**多测不清空**卡了我一发。）\n\n- [[CodeForces 2056C] Palindromic Subsequences](https://codeforces.com/contest/2056/problem/C)\n\n  挺**玄学**的构造题。我们希望大概长这样的结构：\n\n  $$\\underbrace{1,\\ 1,\\ 1,\\ \\dots,\\ 1}_ {a个1},\\ 2,\\ 3,\\ 4,\\ \\dots, a + 3,\\ \\underbrace{1,\\ 1,\\ 1,\\ \\dots,\\ 1}_ {a - 1个1}$$\n\n  这样构造出的答案有 $a(a + 2) + 1 = a^2$ 个，可以通过。稍微分讨一下即可。\n\n  赛后看了一下题解，发现自己好唐：\n\n  $$1,\\ 2,\\ 3,\\ \\dots,\\ n-2, \\ 1,\\ 2$$\n\n- [[CodeForces 2056D] Unique Median](https://codeforces.com/contest/2056/problem/D)\n\n  又是一道**正难则反**，计算坏的序列的个数。这道题的trick挺巧妙的，但没接触过，确实想不出来。发现长度为奇数的序列一定不是坏的，所以只考虑偶数长度序列。对于一个序列的中位数 $x$，将序列中 $\\le x$ 的数化为 $-1$，其它的化为 $1$。若最终区间和为 $0$，那么这个序列就是坏的。另外要注意去重。维护前缀和即可。\n\n- [[CodeForces 2056E] Nested Segments](https://codeforces.com/contest/2056/problem/E)\n\n  组合数学。这个包含或不交的关系恰好和昨天的B差不多。我们想要尽可能多的节点数量，那么需要构造成二叉树。（这里具体不想证明。）对于某一个节点，设其儿子数量为 $cnt_u$，则计算 $\\prod C_{cnt_u - 1}$（卡特兰数）即可。\n\n下午先把E题改了，学习了一下吉司机线段树。这东西挺好理解的，写起来也很爽，但就是又臭又长又难调。\n\n- [[洛谷 P10639] [BZOJ4695] 最佳女选手](https://www.luogu.com.cn/problem/P10639)\n\n  这道题本来是第二道模板题的，但因为第一题相当于第二题的子问题，所以直接冲着这道题来了。写板子即可。（啊啊啊终于还是讨厌上吉司机线段树了啊。）\n\n今天整理了**一些**[去年的日祭](https://www.luogu.com.cn/article/vzqga2oy)。还没把手写的整理上去。\n\n### 2025.1.19 简直糖丸\n\n今日歌曲：All You Have To Do Was Stay\n\n今天上午%你赛，T1爆零了，**简直糖丸**。一共得了 $60$ 分的**高**分。\n\n下午给初二讲题，讲得……**简直糖丸**。\n\n烦球，今天最后几乎啥都没干。\n\n啊不是为什么T1爆炸啊。\n\n### 2025.1.20 简直乐丸\n\n今日歌曲：Daylight\n\n昨晚又是在5.5h内睡满8h的一晚。\n\n今天上午VP [CodeForces Round 998 (Div. 3)](https://codeforces.com/contest/2060)。才做四道，糖丸了。\n\n- [[CodeForces 2060E] Graph Composition](https://codeforces.com/contest/2060/problem/E)\n\n  赛时就很唐。并查集查联通并算连通块即可。\n\n- [[CodeForces 2060F] Multiplicative Arrays](https://codeforces.com/contest/2060/problem/F)\n\n  一道很好的DP+组合数学题。赛时推式子感觉推出来了，结果赛后再一看伪了。很容易发现，$\\sum_{i=1}^{len}[a_i \\neq 1] \\le 16$，所以DP计算非 $1$ 元素的情况，再用组合数学即可。\n\n- [[CodeForces 2060G] Bugged Sort](https://codeforces.com/contest/2060/problem/G)\n\n  这个题就挺有意思的。[这篇题解](https://zhuanlan.zhihu.com/p/19369211716)感觉讲得比官方题解还要清晰。可以观察到，当 $n \\ge 3$，我们可以任意（正常）交换两组的位置。因此，我们可以将两组数进行翻转。换而言之，进行翻转的次数必须是偶数次。这里记翻转次数为 $cnt$。我们把较小的数放在 $a$，较大的放在 $b$。若按 $a$ 排序后 $b$ 有序，那么该组数据有解，当且仅当满足这三个条件之一：\n\n  - $2 \\mid cnt$\n  - $\\exists b_{i - 1} \\lt a_i,\\ 2 \\mid n,\\ 2 \\mid i$，此时可以选择交换奇数组数翻转以改变 $cnt$ 的奇偶性，处于“无敌”状态。\n  - $2 \\nmid n$，此时可以翻转全部以改变 $cnt$ 的奇偶性。\n\n  否则无解。判断**即可**。\n\n今天下午看了一个2025年度第一个[乐子](https://lglg.top/1042691)（[原帖](https://www.luogu.com.cn/discuss/1042691)，[内部帖](https://discourse.xinyoudui.com/t/topic/34584)），**简直乐丸**。\n\n又一个[新梗](https://lglg.top/r/7170050)诞生了：\n\n> @chen_zhe 管理制度错了就要改，不能让无辜的人以泪洗面，如果管理制度还是这样的话，**洛谷将会越来越腐败！！**，我大不了就棕名，我要让洛谷知道瞎诬陷的严重性！\n\n### 2025.1.21 反则难证\n\n今日歌曲：deja vu\n\n今天上午VP [CodeForces Round 999 (Div. 1 + Div. 2)](https://codeforces.com/contest/2061)，状态还好。\n\n- [[CodeForces 2061C] Kevin and Puzzle](https://codeforces.com/contest/2061/problem/C)\n\n  有点思维的DP，题目挺好的。\n\n- [[CodeForces 2061D] Kevin and Numbers](https://codeforces.com/contest/2061/problem/D)\n\n  又是一道正难则反。我们很难将 $a$ 合并，那就把 $b$ 中不合法的进行拆分。用 map 维护即可。其实这道题也好证 ~~，只是想凑一个小标题罢了~~。\n\n- [[CodeForces 2061E] Kevin and And](https://codeforces.com/contest/2061/problem/E)\n\n  这题有点……难评。为什么字典树过不了啊……\n\n  因为 $m$ 很小，所以对 $b$ 进行状压，再将 $a$ 的变化量压进堆里选最大的 $k$ 个即可。（好吧其实不是特别理解。）\n\nF 听不懂。\n\n附一张梗图。\n\n![](https://cdn.luogu.com.cn/upload/image_hosting/omxauv8u.png)\n\n（这里声明一下，不是 jmr 讲得不好，而是实在听不懂。）\n\n### 2025.1.22 比特塞特\n\n今日歌曲：Maroon\n\n年前最后一天了。\n\n上午%你赛 $100+10+60+0=170,\\ rank\\ 4$。T3没用 **bitset** 优化暴扣了 $40$ 分。可恶。\n\n- A - bins （[[洛谷 P6807] [BalticOI 2010 Day2] Matching Bins](https://www.luogu.com.cn/problem/P6807)）\n\n  差分即可。\n\n- C - candies（[[洛谷 P6808] [BalticOI 2010 Day2] Candies](https://www.luogu.com.cn/problem/P6808)）\n\n  [题解](https://www.luogu.com.cn/article/ec6gnuhw)。\n\n\n### 2025.2.8 水讨论区\n\n今日歌曲：Bigger Than The Whole Sky\n\n今天洛谷讨论区关闭了。（以后不能**水讨论区**了。）\n\n这个寒假，什么也没干。一看进度，已经和初二的差不多。但是他们第一遍拉得挺快，估计效果不大。\n\n我如果现在回去，在那边又吃不饱。于是，就只有多肝一肝，把之前的进度补上来。\n\n晚上打[ABC392](https://atcoder.jp/contests/abc392)。\n\n- [[Atcoder ABC392E] Cables and Servers](https://atcoder.jp/contests/abc392/tasks/abc392_e)\n\n  略考细节的题。先找连通块，之后再找每个连通块中的返祖边（即无用的边），再把连通块连通即可。\n\n  （可是这题我赛时AC，后来突然想到一个hack。还没改，烦死了。）\n\n- [[Atcoder ABC392F] Insert ](https://atcoder.jp/contests/abc392/tasks/abc392_f)\n\n  先写一个 $O(n ^ 2)$ 的做法，发现可以分块。所以分块即可。（赛时想到分块但没写，烦死了。）\n\n$\\mathrm{Upd\\ on\\ 2.12}$：\n\n前几天就把 E 改了，今天做了一下 F，写完交上去 TLE 了，也许是常数太大。又看了看题解，发现正解并不是分块，而是数据结构（我就说谁家分块开到 $5e5$）。最后还是放弃了。\n\n### 2025.2.9 终于战胜\n\n今日歌曲：Holyground\n\n[综合题1](https://vjudge.net/contest/691948)。\n\n- [[Gym 103466I] Space Station](https://codeforces.com/gym/II/problem/I)\n\n  神奇搜索题，暴搜+剪枝+略微组合数学即可。\n\n  神奇卡常题目，拼尽全力，2700ms+，终于冲进3s。\n\n- [[Gym 101982D] Count The Bits](https://codeforces.com/gym/101982/attachments)\n\n  很普通的一道DP题，可是赛时都在想组合数学。\n\n  $dp_{i, j}$ 表示到第 $i$ 位模 $k$ 的值为 $j$ 的数中 $1$ 的数量，$cnt_{i, j}$ 表示到第 $i$ 位模 $k$ 的值为 $j$ 的数的数量，直接转移即可。\n\n- [[Gym 102428F] Fabricating Sculptures](https://codeforces.com/gym/102428/problem/F)\n\n  神奇DP题。最开始看题解都没看懂，一是自己确实不理解是怎么算的，二是题解写得比较简略，看了好久才看懂。\n\n  设 $dp_{i, j}$ 表示从上往下一层层放，当前一共放了 $i$ 个，最下面一层放了 $j$ 个的方案数。有方程 $dp_{i, j} = \\sum_{k = 1}^j dp_{i - j, k} * (j + 1 - k)$（希望没写错）。将这个式子拆开再维护前缀和即可。（开了long long见祖宗。）\n\n- [[Gym 104172F] Sum of Numbers](https://codeforces.com/gym/104172/problem/F)\n\n  很有趣的一道题。很容易发现，两个相邻字符串长度之差（的绝对值）为 $0$ 或 $1$。暴搜即可。\n\n  赛时的想法是，将原字符串平均分，再给 $0$ 或 $1$ 的偏移。可是偏移少了一些，虽然没 TLE 但一直 WA，拼尽全力无法战胜。\n\n  赛后再改一改，拼尽全力**终于战胜**。\n\n今天本来说再补补昨天的 F，改改昨天的 E，结果今天的第三题看半天看不懂，昨天的 E 和 F 都没做。\n\n最终今天做了四道题。\n\n感觉心态有点崩。（尤其是看第三题的时候。）\n\n……\n\n### 2025.2.10 ~~放弃即可~~\n\n今日歌曲：Peace\n\n[综合题2](https://vjudge.net/contest/692168)。\n\n今天还做出了一道题。\n\n- [[Gym 100861E] Extreme Programming](https://codeforces.com/gym/100861/attachments)\n\n  看了题解真的好简单。首先我们先确定这些问题的顺序。推推式子，排序即可。现在，我们不用考虑顺序，只用直接背包，找出最大的 $EV$ 与最小的 $ET$ 即可。\n\n  可是这道题不知道哪里写挂了，WA on test 15。**~~放弃即可~~**。\n\n- [[Gym 100217I] Sharing the Sweets](https://codeforces.com/gym/100217/attachments)\n\n  分拆数板子题。（可是我不会。）写板子即可。\n\n  [分拆数 OI Wiki](https://oi-wiki.org/math/combinatorics/partition/)。\n\n- [[Gym 100202A] Little Brackets](https://codeforces.com/gym/100202/attachments)\n\n  这题着实简单。设 $dp_{i, j, 0/1}$ 表示放了 $i$ 个括号，当前高度为 $j$，是否到过最高点（深度为 $k$）的方案数。直接转移即可。\n\n  可是赛时想多了，一直在想组合数学。或许先设方程再推会好一些。\n\n  赛时还因为多测不清空挂了四发。\n\n今天还举办了 [CWOI-N RER 1 > 2](https://www.luogu.com.cn/contest/228091)，感觉对于他们还是太难了。\n\n（今天字符数破 $1e4$ 了。）\n\n### 2025.2.11 ~~放弃即可~~\n\n今日歌曲：Pink Pony Club\n\n模拟赛 $40 + 40 + 100 = 180,\\ rank\\ 2$。\n\n- B - 刀言刀语 （[[洛谷 P6864] [RC-03] 记忆](https://www.luogu.com.cn/problem/P6864)）\n\n  今天给的题解以及同学讲解的都是非矩阵做法，可是听得迷迷糊糊。一下午尝试乱搞做法，结果没搞出来，最后，一道题都没改出来，**~~放弃即可~~**。晚上终于学习了矩阵，基本学懂了，这才发现矩阵有多好用。之后又看了这道题的矩阵+线段树做法，终于基本懂了。\n\n  将这些数据打包成矩阵：$\\begin{bmatrix} ans & cnt & 1 \\end{bmatrix}$。对于操作一，等同于 $\\begin{bmatrix} ans & cnt & 1 \\end{bmatrix} \\times \\begin{bmatrix} 1 & 0 & 0 \\newline 1 & 1 & 0 \\newline 1 & 1 & 1 \\end{bmatrix}$。对于操作二，等同于 $\\begin{bmatrix} ans & cnt & 1 \\end{bmatrix} \\times \\begin{bmatrix} 1 & 0 & 0 \\newline 0 & 0 & 0 \\newline 1 & 1 & 1 \\end{bmatrix}$。对于操作三，若是恢复某个操作，则与操作一二相同；若是删除某个操作，则将这个操作设为单位矩阵（$\\begin{bmatrix} 1 & 0 & 0 \\newline 0 & 1 & 0 \\newline 0 & 0 & 1 \\end{bmatrix}$），不会对答案产生影响。用线段树维护每个操作对应的矩阵，区间求和（求积）即可。\n\n  这道题记得比较详细，毕竟是第一次接触矩阵。\n\n- C - 刀妙构造\n\n  题目：给定一个长度为 $n$ 的排列 $a$，通过尽可能少的操作，使得 $\\forall a_i = i$。判断是否有解。若有解，输出具体的操作。操作的定义：选择 $x, y$ 满足 $1 \\le x, y \\le n, \\left | x - y \\right | = 1, a_x \\ne x, a_y \\ne y$，交换 $a_x$ 与 $a_y$。\n\n  题解：原本就满足 $a_i = i$ 的位置将原数组分割成若干个块。对于每个块，若是目标的一种排列则有解。设当前块为 $[l, r]$，则依次把数 $l \\sim r$ 移到位置 $l \\sim r$。要注意的是，在移动的过程中，可能会使得其它的 $a_i = i$ 成立。所以我们将这些即将成立的位置先进行偏移，再将当前的数移到目标位置即可。\n\n  扩展：尝试在 $O(n \\log n)$ 的时间复杂度内求出有解的排列个数，对 $998244353$ 取模。\n\n这几天强度还是比较高，因为跟进度跟得有点吃力了。今天晚上眼睛疼，难受。\n\n### 2025.2.12 罚时吃饱\n\n今日歌曲：two years\n\n今天上午VP [Codeforces Round 1004 (Div. 2)](https://codeforces.com/contest/2067)，下午改[Codeforces Round 1004 (Div. 1)](https://codeforces.com/contest/2066)。上午C题因为少判了一个条件，**罚时吃饱**了。\n\n- [[Codeforces 2066A & 2067D] Object Identification](https://codeforces.com/contest/2066/problem/A)\n\n  神奇交互题。观察到一个性质：对象 $A$ 的答案可能是 $0$，但对象 $B$ 的答案不可能是 $0$。\n\n  若 $x_1, x_2, \\dots, x_n$ 不是 $1 \\sim n$ 的一个排列，一定可以找到一个不在 $x$ 中的数 $k$，对其与另一个不同的数询问。若是对象 $A$，因为 $k$ 没有向任何点连边，所以答案一定为 $0$。若答案不为 $0$，则是对象 $B$。\n\n  若 $x_1, x_2, \\dots, x_n$ 是 $1 \\sim n$ 的一个排列，那么找到满足 $x_i = 1, x_j = n$ 的 $i, j$。询问 $(i, j)$ 与 $(j, i)$。若是对象 $B$，那么两个答案应该是相等的，并且都 $\\ge n - 1$（因为 $\\left | x_i - x_j \\right | = n - 1$）。然而如果是对象 $A$，那么当 $n \\ge 3$，不可能同时存在一条长度至少为 $n - 1$ 的 $i$ 到 $j$ 的路径与一条长度至少为 $n - 1$ 的 $j$ 到 $i$ 的路径（因为 $2(n - 1) \\ge n$）。综上所述，若两个答案相等并且都 $\\ge n - 1$，则是对象 $B$，否则是对象 $A$。\n\n  ~~按照题解模拟即可。~~\n\n- [[Codeforces 2066B & 2067E] White Magic](https://codeforces.com/contest/2066/problem/B)\n\n  这题似乎挺简单的，只是赛时看了一眼但是没多想。\n\n  首先可以注意到，没有 $0$ 的子序列一定是合法的，有两个及以上的 $0$ 的子序列一定是非法的。所以要么选所有非零元素，要么选所有非零元素与一个 $0$。\n\n  若是选一个 $0$，显而易见，选最左侧的 $0$ 是最优的。于是判断这么选是否合法即可。\n\n- [[Codeforces 2066C & 2067F] Bitwise Slides](https://codeforces.com/contest/2066/problem/C)\n\n  很有意思的 DP 题。\n\n  我们根据题意可以得出，对于时刻 $i$，记 $sum_i = \\oplus_{j = 1}^i a_j$，有 $P \\oplus Q \\oplus R = \\oplus_{j = 1}^i a_j$。于是对于某个时刻，有这三种状态：$\\{sum_i, x, x\\},\\ \\{x, sum_i, x\\},\\ \\{x, x, sum_i\\}$。设 $dp_{i, x}$ 表示这三种状态的情况数，经过推导（具体过程略），可以得出 $dp_{i, sum_{i - 1}} = 3 \\times dp_{i - 1, sum_{i - 1}} + 2 \\times dp_{i - 1, sum_i}$。发现可以滚动。由于值域较大，用 map 维护 DP 即可。\n\n- [[Codeforces 2066D1] Club of Young Aircraft Builders (easy version)](https://codeforces.com/contest/2066/problem/D1)\n\n  有趣的组合数学题。\n\n  因为下面的楼层并不会影响上面的楼层，所以从下往上考虑。对于某一个高度，丢飞机的次数最多为 $c$，假设它实际丢 $k$ 个，则有 $c \\choose k$ 种情况。所以设 $dp_{i, j}$ 表示到了第 $i$ 层楼，已经丢了 $j$ 个飞机的情况数。有转移方程 $dp_{i, j} = \\sum_{k = 0}^ c {c \\choose k} \\cdot dp_{i - 1, j - k}$。\n\n  答案为 $dp_{n, m}$。直接 DP 即可。\n\n  扩展：求证答案为 $nc - c \\choose m - c$。\n\n今天晚上略水……没做题。但是今天一天综合下来……还将就吧。\n\n### 2025.2.13 笑点解析\n\n今日歌曲：evermore\n\n今天 jmr 终于回来了。\n\n今天学习了李超线段树。\n\n- [[洛谷 P4097] 【模板】李超线段树 & [HEOI2013] Segment](https://www.luogu.com.cn/problem/P4097)\n\n  刚开始学李超线段树，觉得挺简单的。其实它跟吉司机线段树有点像，只是维护的东西要少一些，并且代码更好写。\n\n  对于每个节点，考虑维护在它中点处的最高线段编号，那么用类似于吉司机线段树区间取 $\\mathrm{max}$：若当前线段完全优于原有线段，那么直接替换；若当前线段完全劣于原有线段，那么直接舍弃；若当前线段与原有线段有交点，那么递归更新当前线段较大的那一段。对于查询，直接把路径上所有的线段取 $\\mathrm{max}$ 即可。时间复杂度 $O(n\\log^2n)$\n\n- [[洛谷 P4069] [SDOI2016] 游戏](https://www.luogu.com.cn/problem/P4069)\n\n  纯堆码量的题。首先这题一眼树链剖分，一眼李超线段树。这题算是很基础的树剖，只是套的是李超线段树。\n\n  于是 LCA + 树剖 + 李超线段树 就算是码量炸弹了。也许树剖都这样，只是我没怎么写过。所以……先把模板题写了再说。\n\n  - [[洛谷 P3384] 【模板】重链剖分/树链剖分](https://www.luogu.com.cn/problem/P3384)\n \n    第一道真正意义上的树剖。之前倒是写过一个有点树剖思想的贪心（但那个好像是长链剖分）。\n\n    一共交了四发，**笑点解析**：前三发线段树没 pushup。由于当时另外没找到问题，于是我严重怀疑是线段树的问题。然后用那个线段树，写了一个线段树的板子，一测挂了，才发现是没写 pushup，糖丸了。\n\n    第一次写树剖，稍微参考了一下题解代码，但整体还是自己在写。树剖其实挺好理解的。\n\n  写完模板题，该写这道题了。这道题从下午就开始写，一直调到晚上都没调出来，只有明天再补了。\n\n今天 $\\mathrm{CCF}$ 把 $\\mathrm{XXSs}$ 给 $\\mathrm{ban}$ 了。适度阻止竞赛低龄化是有道理的，没必要小学就开始竞赛，而且有些 $\\mathrm{HNO_3}$ 真的很没数值；但另一方面，以后的分数线会有所上升。\n\n今天晚上 $\\mathrm{yishu2}$ 让我们帮他帮另一个人验初赛题。那题……一言难尽。\n\n### 2025.2.14 绝世好题\n\n今日歌曲：Red Wine Supernova\n\n今天%你赛，$\\mathrm{only\\ 130\\ pts}$。\n\n- B - permutation （[[Codeforces 1827B2] [加强版] Range Sorting (Hard Version)](https://codeforces.com/problemset/problem/1827/B2)）\n\n  **绝世好题**之神秘计数（？）题。\n\n  又是一道正难则反。容易发现，答案为：\n\n  $$\n  \\sum_{i = 1}^n (i - 1) \\cdot (n - i + 1) - \\sum_{i, j, k}^{1 \\le i \\le j \\le k \\le n} [\\max_{p = i}^j a_p \\le \\min_{p = j + 1}^k a_p]\n  $$\n\n  考虑枚举 $a_x$ 满足 $a_x = \\max_{p = i}^j a_p$，那么 $a_x \\le \\min_{p = j + 1}^k a_p$。显而易见，$a_{j + 1}$ 是 $a_x$ 右侧第一个比它大的数，那么 $i \\in [p + 1, x], k \\in [j + 1, q - 1]$，其中 $p, q$ 满足 $a_p$ 是 $a_x$ 左侧第一个比它大的数，$a_q$ 是 $a_{j + 1}$ 右侧第一个比 $a_x$ 小的数。维护即可。\n\n  这题……题解给的用 set 维护，可惜常数太大，被 $\\mathrm{yishu2}$ 卡掉了。他又给了个链表的实现，不想看，于是自己开始研究。\n\n  由于要求的值都是最近的最大/最小值，所以考虑使用单调栈维护。$j + 1$ 与 $p$ 都非常好求，可是如何求 $q$ 是个问题。\n\n  当时做这道题的时候自己没想出来，后来看原题题解区才懂。做法是，对于前文所提到的 $i, j$，维护 $n$ 个集合 $S_i$，满足 $\\forall i \\in S_{j + 1}$。接下来倒序遍历 $a$，对于每个 $i$，顺序枚举 $j \\in S_i$，将单调栈中 $\\gt a_j$ 的数弹出，栈顶元素即为 $q$。在将每个 $j$ 操作完后，将 $a_i$ 加入单调栈。正确性证明如下（部分摘自原题题解）：\n\n  记 $(x, j + 1)$ 表示查询 $j + 1$ 右侧第一个比 $a_x$ 小的数。（$x, j$ 含义同上。）若这个询问弹出了 $a_l$，那么 $(x' \\gt x, j + 1)$ 的答案显然不为 $l$。现在需要证明 $(x', (j + 1)' < (j + 1))$ 的答案不为 $l$。\n\n  - 若 $(j + 1)' \\lt x$，因为 $a_x \\lt a_l$，所以 $x$ 可以作为答案，答案不可能是 $l$。\n \n  - 若 $(j + 1)' = x$，因为 $a_{x'} \\lt a_{(j + 1)'} = a_x \\lt a_l$，所以答案不可能是 $l$。\n \n  - 若 $x \\lt (j + 1)' \\lt (j + 1)$，那么 $a_{(j + 1)'} \\lt a_{x}$，否则 $a_x$ 右侧第一个比它的的数不可能是 $a_{j + 1}$，所以 $a_{x'} \\lt a_{(j + 1)'} \\lt a_x \\lt a_l$，答案不可能是 $l$。\n \n  终于证完了。按上述步骤维护即可。\n\n  这题本来就有一定的思维难度。如果用单调栈，这道题的思维难度就更高了。如果用有的数据结构（比如 set），倒是好想好写，**可是 $\\mathrm{yishu2}$ 卡常。**\n\n因为今天一下午加晚上一直苦攻 T2，所以昨天的题还没来得及补。\n\n今天写得很晚了，准确来说已经第二天凌晨了。今天就到这里。\n\n### 2025.2.18 无处不在\n\n今日歌曲：I Forgot You Existed\n\n> “我**无处不在**。”——$\\mathrm{yishu2}$\n\n\n今天在改游戏那道题，最终决定重构！\n\n### 2025.2.20 笑点解析\n\n今日歌曲：The Archer\n\n今天还是在改游戏，最后终于还是改出来了。**笑点解析**又来了。\n\n- 在 $dfs1$ 里计算了 $dfn$。\n\n- $dis$ 在线段树中的编号与实际编号混淆了。\n\n- 另外还有一些很糖的低级错误，比如右儿子写成 $p << 1$ 之类的。\n\n### 2025.2.22 显而易见\n\n今日歌曲：wish you were gay\n\n$\\\\%0\\sin$。\n\n- A - 怎么又是先增后减 （[[Atcoder joisc2014_b] [JOI Day2 T2] たのしい家庭菜園](https://atcoder.jp/contests/joisc2014/tasks/joisc2014_b)）\n\n  ~~论赛时代码只与正解相差两行，赛时是有多糖。~~\n\n  **显而易见**，一个数要么放左边，要么放右边。若放左边，则需要交换当前数与左边逆序对的个数，右边同理。**显而易见**，取较小的一侧的答案。用数据结构维护即可。\n\n### 2025.2.25 数组开小\n\n今日歌曲：mirrorball\n\n- [[Codeforces 241E] Flights](https://codeforces.com/problemset/problem/241/E)\n\n  神秘又简单的差分约束。显而易见，我们只关注在 $1$ 到 $n$ 路径上的点，并且 $1$ 到路径上每个点的距离都是唯一的。那么有 $1 \\le dis_v - dis_u \\le 2$。差分约束即可。\n\n  做的时候由于**数组开小**了，挂了若干发，也是糖丸了。\n\n- [[洛谷 P1993] 小 K 的农场](https://www.luogu.com.cn/problem/P1993)\n\n  模板题。\n\n### 2025.2.27 联合省选\n\n今日歌曲：It's Nice To Have A Friend\n\n今天写了一点[**联合省选** 2025 游记](https://getawaycar1024.github.io/2025/联合省选-2025-游记/)。\n\n- [[洛谷 P4926] 倍杀测量者](https://www.luogu.com.cn/problem/P4926)\n\n  模板题。\n\n- [[洛谷 P2474] [SCOI2008] 天平](https://www.luogu.com.cn/problem/P2474)\n\n  不怎么板但码量极小的题。\n\n  我们要求的是满足 $x_a + x_b \\lt x_i + x_j, x_a + x_b = x_i + x_j, x_a + x_b \\gt x_i + x_j (i \\ne j, i \\ne a, b, j \\ne a, b)$ 的无序二元组 $(i, j)$ 的个数。由于我们并不知道 $x$ 中的具体数值，只知道部分大小关系，又发现我们可以把上述和式转化为差式，所以维护两个数的差的范围即可。\n\n### 2025.3.1&2 正常说话\n\n这两天参加省选。这里用**正常的说话**方式补充一些有关考试题目的内容。\n\n- [[洛谷 P11830] [省选联考 2025] 幸运数字](https://www.luogu.com.cn/problem/P11830)\n\n  钦定中位数为 $x$，设可重集中小于 $x$ 的数的个数为 $l$，等于的是 $e$，大于的是 $r$，那么有 $l + e \\ge r, r + e \\gt l$，所以 $l - e \\lt r \\le l + e$。为了让 $x$ 尽量成为中位数，那么考虑让 $e$ 尽可能大，即能取 $x$ 的都取 $x$。同时可以得到 $l, r$ 的范围，便可判断。用差分维护即可。\n\n- [[洛谷 P11833] [省选联考 2025] 推箱子](https://www.luogu.com.cn/problem/P11833)\n\n  先考虑打一个暴力，随后发现是区间覆盖（覆盖成 $x + i$，其中 $x$ 是给定值，$i$ 是下标。）与区间查询。线段树维护即可。（可是我不会告诉你我写的双 $\\log$ 可能要挂分。）\n\n### 2025.3.4 难度偏高\n\n今日歌曲：The Lucky One\n\n今天补了一下 USACO25JAN，铜组**难度感觉偏高**啊。\n\n- [[洛谷 P11667] [USACO25JAN] Astral Superposition B](https://www.luogu.com.cn/problem/P11667)\n\n  思维题。先处理 ``B``，这两颗星星一定一颗在当前位置，一颗在左上方对应的位置。接下来处理 ``G``，如果当前位置能够由已有的星星移动而来，则忽略；否则当前位置需要一个星星。即可。\n\n- [[洛谷 P11672] [USACO25JAN] Table Recovery S\n](https://www.luogu.com.cn/problem/P11672)\n\n  这题一直没改，今天终于改了。先统计出每个数出现了多少次，仅出现了一次的两个数中的一个便是第一个数。又由于第一个数所在的行/列中的每个数的出现次数是不重复的，于是就可以根据第一个数推出整个表格。比较两个答案中更小的一个输出即可。\n\n### 2025.3.6 正难则反\n\n今日歌曲：Naked In Manhattan\n\n今天中午 C 老师请吃饭，回来就出省选成绩了。省选总分 $232$，折合 $58.71$，$\\mathrm{CW\\ Junior\\ rk\\ 3}$。（其实一共也就 $6$ 个初中生。）\n\n今天略水。\n\n- [[洛谷 P11672] [USACO25JAN] Reachable Pairs G](https://www.luogu.com.cn/problem/P11674)\n\n  有趣的**正难则反**。对于 $1$ 操作，相当于把当前点换成一个超级原点并不参与计数。所以考虑倒推，先建边（并查集合并）再加贡献。具体地，对于一条边 $u \\to v (u \\lt v)$，若：\n\n  - $s_u = 1, s_v = 1$：由于两个点都是超级原点，直接合并 $u, v$ 所在的块。\n\n  - $s_u = 1, s_v = 0$：当枚举到 $v$ 时合并 $u, v$ 所在的块。\n \n  - $s_u = 0$：当枚举到 $u$ 时合并 $u, v$ 所在的块。\n \n  枚举到一个点再加入贡献即可。\n\n### 2025.3.8 ~~打表可得~~\n\n今日歌曲：Starlight\n\n$\\\\%0\\sin$。\n\n- A - 114514\n\n  题目：定义函数 $f(x)$，其中 $x$ 是一个长度为 $n$ 的序列。这个函数的值 $y$ 满足：\n\n  - $y$ 的长度为 $n$。\n  \n  - $y$ 中的元素互不相同。\n \n  - $\\forall i \\in [1, n], x_i \\le y_i$。\n \n  - $y$ 是满足上述条件的序列中，字典序最小的。\n \n  现给定 $y$，求有多少个序列 $x$ 使得 $f(x) = y$。\n\n  题解：__~~打表可得~~__，每个位置可能的值是独立的，即对于任意一个**位置** $i$，$a_i$ 的取值集合不会随其他值的改变而改变。设 $vis_i$ 表示**值** $i$ 是否出现过，那么对于 $a_i$ 的取值范围就是 $[l, i]$，其中 $l$ 满足 $\\forall k \\in [l, i], vis_k = 1$ 且 $vis_{l - 1} = 0$。并查集维护即可。\n\n- C - 深黯「军团」\n\n  题目：给定 $n, k, mod$ 与一个长度为 $n$ 排列 $a$。计算从 $a$ 开始的接下来 $k$ 个排列的逆序对个数之和。\n\n  题解：神秘数位 DP。这题赛时还是想到了许多，但是考试时误认为 $a$ 的较高位不会改变，所以挂成 $20$ 分（数据好水）。\n\n  赛时想到了通过求一个排列的逆序对来算排名，也想到了要求的就是排名在一个区间内的排列的逆序对数之和，还**~~通过打表~~**想到了全排列的逆序对个数的 DP，甚至还想到了类似于阶乘进制的东西，可是因为不会[康托展开](https://oi-wiki.org/math/permutation/#%E6%8E%92%E5%90%8D)而没写出来。\n\n  具体地，将 $k$ 与排列 $a$ 康托展开。由于康托展开的值的数位之和就是逆序对个数，所以答案为 $\\sum_{i = a}^{a + k} count(i)$，其中 $count(i)$ 表示 $i$ 的数位之和。对于重复的部分，直接 DP 即可。\n\n### 2025.3.11 观察样例\n\n今日歌曲：Getaway Car\n\n要改名了。今天 VP [Codeforces Round 1008 (Div. 2)](https://codeforces.com/contest/2078)，打得烂的一匹，最开始只做了 A 和 B，不过幸好在 2:28 把 E AC 了，不然今天晚上整个人都不好了。\n\n- [[CodeForces 2077A & 2078C] Breach of Faith](https://codeforces.com/contest/2077/problem/A)\n\n  赛时一直在求 $a_1$，然后就被卡死了。\n\n  事实上，发现 $a_2$ 更好求一些。$a_2 = a_1 + a_{2n + 1} + a_3 - a_4 + a_5 - a_6 + \\dots + a_{2n - 1} - a_{2n}$。显而易见，把最大值作为 $a_1$ 即可不重复。排序即可。\n\n- [[CodeForces 2077B & 2078E] Finding OR Sum](https://codeforces.com/contest/2077/problem/B)\n\n  神秘交互题。以下均讨论八位整数。**观察样例**发现，询问 $0$ 似乎比较有用，可以直接得到 $x + y = sum$。再~~根据直觉~~，考虑询问 $01010101$，将得到的答案 $ans$ 再减去 $sum$ 就可以得到 $1$ 的贡献。为了不让每一位的贡献重叠，我们便想到空一个位置放一个 $1$。这样，我们就可以根据这些数位的贡献来算出这些数位的和（指 $x, y$ 对应数位之和）。剩下未知的数位也便可以根据 $sum$ 与已知的数位求出。显而易见，求答案时我们并不在意当前数位具体的值，只在意数位和。所以对于 $m$ 的每一位只用分讨 $0$ 或 $1$ 即可。\n\n  这种题确实挺直觉的，个人觉得也比较靠运气。~~比如我 C 想了半天就是想不到，这题基本是看一眼就有点想法而且就对了，甚至还是一发入魂。~~\n\n### 2025.3.15 嗨克数据\n\n今日歌曲：This Is Why We Can't Have Nice Things\n\n$\\\\%0\\sin$。\n\n- D - 完美的答卷\n\n  题目：给定长度为 $n$ 的数组 $a$，设 $f_{l, r} = (\\max_{i = l}^r a_i) \\oplus (\\min_{i = l}^r a_i)$，求 $\\max_{1 \\le i \\le j \\le n} f_{i, j}$。\n\n  题解：本题数据过水，以至于赛时对拍拍出了问题但是交到 OJ 上过了。赛时这题也想到了许多，可是逻辑并不清晰，最后还是看了题解并与 dpfs 讨论才想出了以下的解法。\n\n  钦定 $a_i$ 是一个区间的最大值，$a_j$ 是这个区间的最小值，且 $j \\lt i$。设 $pre_i$ 表示 $i$ 左侧第一个比 $a_i$ 大的位置，则 $j \\in (pre_i, i)$，且 $j$ 在 $[1, i]$ 的单调（递增）栈中，单调栈 + 01trie 维护即可。可是，上述两个集合的交集不一定从 $1$ 开始，所以对于 trie 树中的一个节点 $i$，维护 $mx_i$ 表示经过该点的数的**下标的最大值**，便可以解决。可是删除又成为了一个问题。考虑用 vector 暴力维护每个 $mx_i$ 的历史值，理论上时间复杂度不变，只是常数巨大。\n\n  改完之后，就开始造 **hack 数据**了。有效果但不多。\n\n### 2025.3.18 极限 AC\n\n今日歌曲：Paper Rings\n\n今天 VP [Codeforces Edu Round 176](https://codeforces.com/contest/2075)。由于准备 VP 时 CF 还在系统测试，所以并不算严格意义上的 VP。最后一共做了 4 道，而 D 是在 VP 1:54 时才 AC，此前还有 3 发罚时。也是**极限 AC**。\n\n- [[CodeForces 2075C] Two Colors](https://codeforces.com/contest/2075/problem/C)\n\n  先将 $a$ 排序。发现对于某一种颜色，能够与其搭配的颜色都是连续的一段。所以前缀和并动态维护能够搭配的区间即可。注意略特判 $a_i = n$ 的情况。\n\n- [[CodeForces 2075D] Equalization](https://codeforces.com/contest/2075/problem/D)\n\n  注意到花费不能重复，所以考虑背包 DP。设 $dp_{i, j}$ 表示将 $x$ 右移 $i$ 位、将 $y$ 右移 $j$ 位的最小代价，转移十分显然，即可 $O(\\log_2^2 n)$ 无脑做。然而由于我赛时**太有脑了**，非要写 $O(\\log_2 n)$，最后调了好久才过。~~下次再也不长脑子了。~~\n\n### 2025.3.20 疑似双休\n\n今日歌曲：I Hate It Here\n\n后天不用上课，这周**疑似可以双休**了！\n\n今天在补好题推荐。\n\n- [[CodeForces 2078D] Scammy Game Ad](https://codeforces.com/contest/2078/problem/D)\n\n  很符合“时下流行”的题目了。\n\n  考虑 DP，设 $dp_{i, 0/1}$ 表示从第 $i$ 个左/右门开始，到最后一个门的**最大倍率**。转移也是十分显然的。对于第 $i$ 对门通过加法新产生的人数 $x$，将答案加上 $x \\cdot \\max(dp_{i + 1, 0}, dp_{i + 1, 1})$ 即可。注意最初还有 $2$ 个人。\n\n### 2025.3.22 为什么没有正经的标题？\n\n并不是双休，在家里 VP 模拟赛。\n\n### 2025.3.25 为什么没有正经的标题？\n\n打 USACO，菜得银组一道都不会。\n\n### 2025.3.27 为什么还是没有正经的标题？\n\n- [[CodeForces 2077C] Binary Subsequence Value Sum](https://codeforces.com/contest/2077/problem/C)\n\n  极其有趣的题目了。\n\n  显而易见，$F(v, l, r) = one(v, l, r) - zero(v, l, r)$，所以一个字符串的权值 $W(v) = \\lfloor \\frac{(one(v) - zero(v))^2}{4} \\rfloor$。把 $0$ 换 $-1$，那么 $W(v) = \\lfloor \\frac{sum^2(v)}{4} \\rfloor = \\frac{sum^2(v) - (sum(v) \\mod 2)}{4}$。继续将这个式子化简即可，~~这里不再赘述~~。\n\n- [[CodeForces 2082B] Floor or Ceil](https://codeforces.com/contest/2082/problem/B)\n\n  从二进制角度思考，向上取整等同于先加一再右移一位，向下取整则是直接向右移一位。所以，若一个向上取整操作后还有一个向下取整操作，那么这个向上取整操作相当于是无效的。又有在 $n + m$ 次操作之后，**最大值最多比最小值大一**。所以对于最小值，先向上取整再向下取整即可，最大值反之。\n\n- [[CodeForces 2081A] Math Division](https://codeforces.com/contest/2081/problem/A)\n\n  考虑多操作一次的期望。多操作一次，则代表在第 $n$ 位上产生了进位，又因为 $a_n = 1$，所以前 $n - 1$ 位产生了进位（第 $n$ 位是最高位）。设 $dp_i$ 表示前 $i$ 位进位的期望，则：\n\n  $$\n  dp_i = \\begin{cases}\\frac{1}{2} \\times dp_{i + 1},\\ a_i = 0\\newline\\frac{1}{2} \\times (1 - dp_{i + 1}) + dp_{i + 1},\\ a_i = 1\\end{cases}\n  $$\n\n  直接 DP 即可。\n\n### 2025.4.1 愚人节\n\n今日歌曲：Forever Winter\n\n~~别问了。因为今天是**愚人节**。~~\n\n因为我的日祭之前断更了一段时间，今天终于补上了。\n\n今天改不动题，于是在出题。\n\n### 2025.4.6 水讨论区\n\n讨论区居然真的回来了，又可以**水讨论区**了（。\n\n今天 VP [Codeforces Round 1015, Div. 1 + Div. 2](https://codeforces.com/contest/2084)，赛后结算时，发现机房网络得了 MVP。详见犇犇。\n\n前四题都是沟槽构造，不再赘述。\n\n- [[Atcoder ABC400F] Happy Birthday! 3](https://atcoder.jp/contests/abc400/tasks/abc400_f)\n\n  考虑正难则反。问题转化为：\n\n  > 一个环上有 $n$ 个物品，颜色分别为 $col_i$，每次操作选择两个数 $i, j$ 使得 $\\forall k \\in [i, j],  col_k = col_i \\lor col_k = 0$，对 $[i, j]$ 进行“漂白”，即将颜色都设为 $0$。一次操作的代价为 $j - i + 1 + x_{col_i}$。求将整个环漂白的最小总代价。\n  \n  先断环为链。设 $dp_{i, j}$ 表示将 $[i, j]$ 漂白的最小代价，那么显然有 $dp_{i, j} = \\min_{k = i}^{j - 1} dp_{i, k} + dp_{k + 1, j}$。\n\n  设 $f_{i, j}$ 表示使 $[i, j]$ 能够漂白的最小代价，那么显然有 $f_{i, j} = \\min_{k = 1}^{j - 1} f_{i, k} + dp_{k + 1, j}$。当 $col_i = col_j$ 时，有 $f_{i, j} = \\min (f_{i, j}, f_{i, j - 1}), dp_{i, j} = \\min (dp_{i, j}, f_{i, j} + j - i + x_{col_i})$。\n\n  答案即为 $\\min_{i = 1}^n dp_{i, i + n - 1}$。\n\n- [[Codeforces 2086E] Zebra-like Numbers](https://codeforces.com/contest/2086/problem/E)\n\n  确简单的啊，可是自己就是想不到。\n\n  考虑计算一个数的斑马值。贪心地，尽量选大的斑马数减即可。\n\n  考虑记搜，设 $dp_{i, j}$ 表示 $[1, i]$ 中斑马值为 $j$ 的数的个数。那么显然有 $dp_{i, j} = dp_{i - mx, j - 1} + dp_{mx - 1, j}$，其中 $mx$ 是不大于 $i$ 的最大的斑马数。具体地，$dp_{i - mx, j - 1}$ 表示 $[mx, i]$ 中斑马值为 $j$ 的数的个数，$dp_{mx - 1, j}$ 表示 $1, mx - 1$ 中斑马值为 $j$ 的数的个数。\n\n### 2025.4.8 过水了\n\n今日歌曲：it's time to go\n\n**过水了**今天。\n\n### 2025.4.10 证明略\n\n今日歌曲：The Albatross\n\n- [[Atcoder ARC196A] Adjacent Delete](https://atcoder.jp/contests/arc196/tasks/arc196_a)\n\n  唐题啊，可是和我相比还是我更唐。\n\n  假设 $n$ 是偶数。如果我们忽略删除相邻数的条件，即可以任选两个数相减，那么答案应该是前 $\\frac{n}{2}$ 大的数（记作“较大数”）的和减去前 $\\frac{n}{2}$ 小的数（记作“较小数”）的和。\n\n  容易发现，当我们只能选相邻数相减时，依然可以达到这个答案，因为在任意时刻，总存在至少一对较大数与较小数相邻。\n\n  当 $n$ 是奇数，那么一定有一个元素不被选，且这个元素一定在奇数位，这样才能把数组分成长度为偶数的两段。枚举不被选的位置，用对顶堆维护前后两段的答案即可。\n\n- [[Atcoder パ研合宿2024 第3日 E] Roller Coaster](https://atcoder.jp/contests/arc196/tasks/arc196_a)\n\n  人类智慧啊。选高度差最大的边即可。**证明略。**\n\n- [[Atcoder パ研合宿2024 第3日 G] Bracket Sequence](https://atcoder.jp/contests/pakencamp-2024-day3-2/tasks/pakencamp_2024_day3_2_g)\n\n  极一眼啊，大概十分钟切了吧。跟翻转括号序列的一个区间那题差不多，这题还简单一点。\n\n  注意到位置 $i$ 可由 $i - 1$ 与跟 $i$ 位置高度相同的位置转移而来。拿一个桶维护后者即可，遇到右括号时记得清零。\n\n### 2025.4.12 写了跟写了一样\n\n今日歌曲：august\n\n模拟赛。\n\n- A - 倒水\n\n  题目：有三个容量分别为 $x, y, z$ 的杯子与一个容量为 $n$ 的一个桶，每次可以：\n\n  - 把一个杯子灌满；\n  - 把一个杯子的水倒出去；\n  - 把一个杯子的水倒到另一个杯子直到这个杯子空了或另一个杯子满了；\n  - 把一个杯子的水倒到桶里。\n\n  对于 $[1, N]$ 中的每一个 $n$，求要使桶装满水，最少的操作次数。\n\n  题解：$\\mathrm{yishu2}$ 发的题解**写了跟写了一样**。\n\n  容易发现，经过转化，可以得到两种操作：向桶里加 $x / y / z$ 单位水与从桶里舀出 $x / y / z$ 单位水回到对应的杯子（后者是操作一与操作三的结合），每次操作的代价都为二。注意到，对于某一个水杯，若我们用它进行的最后一个操作是操作二，那么代价为一，因为不用把舀出来的水倒出去。设 $dp_{i, j}$ 表示桶里有 $i$ 单位水的最小代价，$j$ 表示三个水杯是否最后用于操作二，那么先正着 DP 一遍，即全部使用操作一，再反着 DP 即可。统计答案时应统计 $dp_{i, j} - popcount(j)$。\n\n- B - 让他们连通 （[[Codeforces 1706E] Qpwoeirut and Vertices](https://codeforces.com/problemset/problem/1706/E)）\n\n  居然能场切 $2300$。\n\n  要让区间 $[l, r]$ 联通，等价于 $\\forall i \\in [l, r)$，$i$ 与 $i + 1$ 联通。设 $time_i$ 表示 $i$ 与 $i + 1$ 联通的时间，则答案为 $\\max_{i = l}^{r - 1} time_i$，可以用 ST 表维护，常数又小又好写。\n\n  对于 $time_i$，考虑启发式合并。在合并时，枚举较小的集合的元素，并判断它是否与另一个集合中的元素相邻即可。赛时因为没判 $fa_x = fa_y$ 被硬控了半个小时。\n\n### 2025.4.15 不想证明\n\n今日歌曲：cardigan\n\n- [[Atcoder パ研合宿2024 第3日 G] 門松](https://atcoder.jp/contests/pakencamp-2024-day3-1/tasks/pakencamp_2024_day3_1_k)\n\n  无脑做啊，**不想证明**。\n\n- [[Atcoder パ研合宿2024 第3日 H] Big XOR Game](https://atcoder.jp/contests/pakencamp-2024-day3-1/tasks/pakencamp_2024_day3_1_H)\n\n  ~~这题评分比括号序列还要低。~~\n\n  从高到低讨论，对于每一位，设当前位上是 $1$ 的数的个数是 $cnt$，那么有：\n\n  ```cpp\n  if(((cnt + 1) / 2) & 1 and (cnt / 2) & 1 ^ 1) Alice;\n  if(((cnt + 1) / 2) & 1 ^ 1 and (cnt / 2) & 1) {\n  \tif(n & 1) Bob;\n  \telse Alice;\n  }\n  ```\n\n  不想详细说明。\n\n### 2025.4.19 输入挂了\n\n  今日歌曲：Sad Beautiful Tragic\n\n  TTPD 一周年了。\n\n  今天模拟赛因为**输入挂了** $76 pts$，机房 rating ~~暴涨~~暴跌。\n\n  - A - 说唱入门教学\n\n    题目：给定一首歌的歌词（以拼音形式），每两句话一一匹配，$\\forall i \\in [1, m]$，求出 $i$ 押的个数。\n\n    题解：题面好唐。先把韵母处理出来，然后 trie 树即可。常数极大。\n\n  - B - 画画入门教学\n\n    构造题，手动推一推小样例即可。\n\n### 2025.5.5 了跟了一样\n\n今日歌曲：Fifteen\n\n又断更了半个月。\n\n前几周学了一下 AC 自动机，~~但是**学了跟学了一样**。~~\n\n前几天终于把那套题出完了，~~但是**出了跟出了一样**。~~\n\n昨天考试，听了评讲，~~但是**改了跟改了一样**。~~\n\n晚上打 ARC，~~但是**打了跟打了一样**。~~\n\n- [[Atcoder ARC197C] Removal of Multiples](https://atcoder.jp/contests/arc197/tasks/arc197_c)\n\n  唐题啊，但是赛时一直在想整除分块之类的，结果没想出来。\n\n  但是这题也就真纯唐，用线段树维护区间内留下的数的数量即可。需要证个上界。\n\n- [[Atcoder ARC197D] Ancestor Relation](https://atcoder.jp/contests/arc197/tasks/arc197_d)\n\n  好题啊好题。记 $b_i$ 表示矩阵的第 $i$ 行的内容（用 bitset 维护）。\n\n  考虑什么时候有 $a_{u, v} = 1$。因为与孩子有关系的节点一定与祖先有关系，但与祖先有关系的节点不一定与孩子有关系。所以有 $b_u | b_v = b_u$ 或 $b_u | b_v = b_v$，前者对应 $u$ 是 $v$ 的祖先，后者则对应 $v$ 是 $u$ 的祖先。容易证明这是一个充要条件，那么若 $a_{u, v} = 0$，则一定不存在 $b_u | b_v = b_u$ 与 $b_u | b_v = b_v$。\n\n  接下来考虑一种特殊情况：$b_u = b_v$，此时 $u, v$ 在一条没有任何分岔的一条“链”上，那么这条链上的节点的位置就可以互换。设一组 $b_i$ 相同的点的数量为 $sz$，那么这一组点可以带来 $sz!$ 的贡献。\n\n  此外，$\\forall i \\in [1, n]$，显然需要有 $a_{i, 1} = 1, a_{1, i} = 1$。那么我们就总结出以下三条条件或贡献：\n\n  - $\\forall i \\in [1, n], a_{i, 1} = 1, a_{1, i} = 1$。\n  - $b_u | b_v = b_u$ 或 $b_u | b_v = b_v$，当且仅当 $a_{u, v} = 1$。（等价于：$a_{u, v} = 1$，当且仅当 $b_u | b_v = b_u$ 或 $b_u | b_v = b_v$。）\n  - 对于极多的 $sz$ 个 $b_i$ 相同的数，可以带来 $sz!$ 的贡献。\n\n  于是按以上三点计算即可。\n\n### 2025.5.18 宇宙射线\n\n由于**宇宙射线**的影响，这里遗失了一篇日祭。主播不想补日祭了。\n\n前几天又断更了，应该是在补 CQ CCPC 的题吧。主播不想补日祭了。\n\n（我明明写了的，可不知道这篇日祭怎么就消失了。）\n\n### 2025.5.22 主播不想补日祭\n\n今日歌曲：High Infidelity\n\n前天又学了一下 exgcd。**主播不想补日祭**了。\n\n今天考试。\n\n- A - 三重移位 （[[Atcoder ARC136B] Triple Shift](https://atcoder.jp/contests/arc136/tasks/arc136_b)）\n\n  略为神秘。观察到，进行一次操作后，逆序对个数的变化量一定是偶数，所以 $a$ 与 $b$ 的逆序对个数的差值必须是偶数。另外，当 $a$ 中存在重复的元素，那么相当于可以造一对逆序对出来，此时一定有解。\n\n- B - 最小差分和 （[[Atcoder ARC147C] Min Diff Sum](https://atcoder.jp/contests/arc147/tasks/arc147_c)）\n\n  [题解](https://www.luogu.com.cn/article/u6eyulti)。\n\n  更好的做法如下：假设当前 $x$ 有序，那么可以拆贡献。拆下来是 $\\sum_{i = 1}^\\frac{n}{2} (n - 2i + 1)(x_{n +1 - i} - x_i)$。于是让 $x_{n + 1 - i}$ 尽量小，$x_i$ 尽量大。将 $l$ 降序排序，将 $r$ 升序排序即可。（主播不想写了，看不懂就去看原题题解吧。）\n\n- C - 前缀与后缀 （[[洛谷 P9180] [COCI 2022/2023 #5] Slastičarnica](https://www.luogu.com.cn/problem/P9180)）\n\n  [To do]\n\n- D - 贪吃蛇 （[[洛谷 P7078] [CSP-S2020] 贪吃蛇](https://www.luogu.com.cn/problem/P7078)）\n\n  [To do]\n\n### 2025.5.24 竟然草过去了\n\n今日歌曲：You're on Your Own, Kid\n\n今天叕考试。\n\n- A - 红魔乡 （[[TopCoder 15693] Fixed Point Reversals](https://vjudge.net/problem/TopCoder-15693)）\n\n  显然好做。把翻转区间看成交换元素即可，唯一的限制是当交换的两个元素在 $pos$ 的两侧时，这两个元素需要关于 $pos$ 对称。\n\n- B - 妖妖梦 （[[洛谷 P4576] [CQOI2013] 棋盘游戏](https://www.luogu.com.cn/problem/P4576)）\n\n  当且仅当黑棋和白棋出生在一起时，白棋能赢，否则赢家一定是黑棋。那么黑棋就尽量快速解决战斗，白棋就尽量多拖延，所以白棋转移状态时取最大值，黑棋选择状态时取最小值即可。\n\n- C - 永夜抄 （[[TopCoder 10945] Rectangular Island](https://vjudge.net/problem/TopCoder-10945)）\n\n  ``long double`` 还是太玄学了，**竟然草过去了**。发现左右移动和上下移动其实是相对独立的，所以单独处理即可。设 $row_i$ 表示在左右方向上移动了 $i$ 步，还在格子里的概率，$col_i$ 同理，它们是可以 $O(ns)$ 处理出来的。接下来枚举 $i$ 表示左右方向上移动的次数，那么此时的贡献应该是 $row_i \\cdot col_{s - i} \\cdot {s \\choose i} \\cdot \\frac{1}{2^s}$。$s \\choose i$ 显然容易维护，可是发现 $\\frac{1}{2^s}$ 这东西容易炸掉，又发现在计算 $row_i$ 和 $col_{s - i}$ 时一共恰好迭代了 $s$ 次，所以在计算 $row$ 和 $col$ 时每迭代一次时乘上 $\\frac{1}{2}$ 即可。\n\n- D - 花映冢\n\n  题目：给定一个图，点数和边数都是 $10^5$ 级别的，可能有环、自环和重边，求是否存在一条从 $1$ 出发的路径可以经过所有点至少一次。（可以重复经过边或点）。\n\n  题解：显然先把自环和重边判了，接下来 Tarjan 缩点，再拓扑排序即可。\n\n### 2025.5.26\n\n今天补题。见 5.22 与 5.24。\n\n### 2025.5.29\n\n今日歌曲：Cruel Summer\n\n今天继续补题。见 5.22。","tags":["记录"],"categories":["ESSAY"]},{"title":"[ARC147C] Min Diff Sum 题解","url":"/2025/ARC147C-Min-Diff-Sum-题解/","content":"\n本文提供一种另类做法。~~虽然我的代码从实现以及常数上都更劣一些。~~\n\n考虑原式的几何意义，即在数轴上的 $n$ 个区间内各选一个点使得这 $n$ 个点两两距离之和最小。\n\n考虑什么时候距离之和最小，显然是所有点都尽量向某一个位置靠拢时。所以钦定中心点，让其它所有点都尽量向这个点靠拢，再暴力计算贡献。时间复杂度 $O(n^2V)$。\n\n注意到，中心点取在非端点显然时不会更优，所以可以离散化。时间复杂度 $O(n^3)$ 。\n\n现在考虑优化计算原式的过程。考虑拆贡献。$n$ 个点把数轴分成 $n - 1$ 条线段（以及两条射线）,那么第 $i$ 条线段就会被计算 $i \\cdot (n - i)$ 次。这是显然的。那么我们可以现将这 $n$ 个点排序，再按上述过程计算。时间复杂度 $O(n^2 \\log n)$。\n\n容易发现，在中心点移动的过程中，有许多点的位置并不会随着中心点位置的改变而改变，所以考虑动态维护每个点的位置以及贡献。设当前中心点位置为 $pos$，可以把 $n$ 个点分成 $3$ 段：\n\n- $r_i \\lt pos$，这些点的位置固定在了 $r_i$，不会再改变。\n\n- $l_i \\le pos \\le r_i$，这些点的位置会随着中心点位置的改变而改变，且它们的位置都是 $pos$。\n\n- $pos \\lt l_i$，这些点的位置暂时固定在了 $l_i$。\n\n那么我们可以动态维护这三段的端点。当 $pos$ 遇到了一个左端点时，相当于将一个点从第三段移到第二段；当 $pos$ 遇到了一个右端点时，相当于把一个点从第二段移到了第一段。\n\n在此同时，动态维护每段内部的贡献。第一三段的贡献只需要在遇到端点时更新，第二段内部显然没有贡献。$总贡献 = 第一段的贡献 + 一二段交界处贡献 + 二三段交界处贡献 + 第三段的贡献$。\n\n于是这道题就做完了。\n\n[提交记录](https://atcoder.jp/contests/arc147/submissions/66184899)。","tags":["题解"],"categories":["ESSAY"]},{"title":"[ABC407F] Sums of Sliding Window Maximum 题解","url":"/2025/ABC407F-Sums-of-Sliding-Window-Maximum-题解/","content":"\n一眼题啊。设 $a_i$ 左侧第一个**不比它小**的数的位置为 $lft_i$，它右侧第一个**比它大**的数的位置为 $rgt_i$。（这样可以保证既不漏算又不重复计算。）那么对于 $a_i$，它可能作为最大值的极长区间显然是 $(lft_i, rgt_i)$。这个区间又被 $a_i$ 分为左右两段。设两段中较短的一段长度为 $mn = \\min\\{i - lft[i], rgt[i] - i\\}$，较长一段长度为 $mx = \\max\\{i - lft[i], rgt[i] - i\\}$，总长度为 $len = rgt_i - lft_i + 1$。那么 $a_i$ 可以带来以下贡献：\n\n- $\\forall k \\in [1, mn], ans_k \\leftarrow ans_k + k \\cdot a_i$；\n\n- $\\forall k \\in (mn, mx], ans_k \\leftarrow ans_k + mn \\cdot a_i$；\n\n- $\\forall k \\in (mx, len], ans_k \\leftarrow ans_k + (len + 1 - k) \\cdot a_i$。\n\n将第三组式子拆为：\n\n- $\\forall k \\in (mx, len], ans_k \\leftarrow ans_k + (len + 1) \\cdot a_i, ans_k \\leftarrow ans_k - k \\cdot a_i$。\n\n于是维护两个差分数组即可。第一个差分数组 $c1_i$ 维护的实际值就是 $c1_i$，第二个差分数组 $c2_i$ 维护的实际值是 $i \\cdot c1_i$。\n\n于是就做完了。\n\n[提交记录](https://atcoder.jp/contests/abc407/submissions/66119295)。","tags":["题解"],"categories":["ESSAY"]},{"title":"别样的罚时大战","url":"/2025/别样的罚时大战/","content":"\n本文是一篇 **CQ CCPC** 流水帐游记，想了解题目做法的请移步。\n\n### Day $-\\infty$\n\n和 qcz, jmr 分到一组了。赛后一结算，jmr 是 MVP，hyc 是躺赢狗。\n\n队名叫作 grass8cao。\n\n### Day $-\\infty + 1$\n\n时间安排出来了，结果是当天坐高铁往返，早上 6:20 就出发呜呜呜。\n\n### Day 0\n\n早上 5:50 就起床了。\n\n9 点左右高铁到达重庆西。\n\n10点过一点到考场开始比赛。策略是 jmr 和 qcz 轮着写代码，我负责翻译和想点子。\n\n1:18 AC 了 6 道题，~~一共吃了整整 4 发罚时~~。\n\n接下来的 50 分钟内，jmr 把 E 过了，甚至还是首 A。\n\n随后又用了半个小时写 D。\n\n之后 jmr 开始写 DS G 题。写了一个小时，~~吃了 5 发罚时后~~，终于在封榜之前过了，还是首 A。这几道题我们的策略是：“赢在过题数上，不赢在罚时上，~~罚时已经不重要了~~！”\n\n在封榜之前，基本都是 Zi_Gao 的队第一，我们以同样的 AC 数~~与优秀的罚时~~紧随其后。\n\n于是 qcz 又继续写前面没写完的 J。在 jmr 的 $+\\infty$ 组 hack 与~~**整整 9 发罚时**~~之后，也是终于调过了。\n\n此时已经 4:31。我在 jmr 休息的时候告诉他 I 可做，可是最开始我没讲清楚，他也没听。后来他突然会 I 了，相比 K 的 NTT，这道欧拉回路显然更好写。于是 jmr 果断选择 I，20 分钟后 AC。~~中间吃了一发罚时~~。\n\n此时 4:51，基本已经没有悬念了（吗？）。\n\n可这时我们发现了几个 BYD 藏题哥，于是开始担心。不过算一算，前五是没问题，因为算上 Zi_Gao 一个队在前面，还有大概三队藏题哥。\n\n比赛结束了，可还没解榜。后来问 Zi_Gao 他们队，结果他们封榜之后就没写了，最终定格在 9 题。\n\n后来吃了火锅上了大巴不知道过了多久，终于看到榜单了。结果那几队藏题哥的许多题都没过。于是就以 11 道题与~~优秀的 21 发罚时~~的成绩成为榜一。\n\n于是我就真的成为躺赢狗了。躺着拿（成绩等同）金牌与家长老师的各种表扬。","tags":["游记"],"categories":["ESSAY"]},{"title":"[ABC145F] Laminate 题解","url":"/2025/ABC145F-Laminate-题解/","content":"\n想必大家都会积木大赛。\n\n若修改 $h_i$，考虑如何让它带来的贡献最小。根据积木大赛的结论，只需让 $h_i' \\in [\\min\\{h_{i - 1}, h_{i + 1}\\}, \\max\\{h_{i - 1}, h_{i + 1}\\}]$，这个位置就不会带来任何的贡献，可以认为我们删除了第 $i$ 个位置。显然，$\\forall i \\in [1, n]$，总存在 $h_i'$ 满足以上条件。\n\n那么问题就变成了，原本有 $n$ 个位置，可以删除最多 $k$ 个位置，求最小答案。于是自然而然地想到了 DP。\n\n设 $dp_{i, j, k}$ 表示现在在第 $i$ 个位置，删除了 $j$ 个位置，上一个没有被删除的位置是 $k$ 的最小答案。转移方程：\n\n$$\ndp_{i, j, k} =\n\\left \\\\{\n\\begin{aligned}\n& dp_{i - 1, j - 1, k},\\ k \\in [0, i) \\newline\n& \\min_{p \\in [0, i)}\\{dp_{i - 1, j, p} + \\max\\{h_i - h_p, 0\\}\\},\\ k = i\n\\end{aligned}\n\\right.\n$$\n\n时间复杂度 $O(n^3)$。\n\n[提交记录](https://atcoder.jp/contests/abc145/submissions/65585483)。","tags":["题解"],"categories":["ESSAY"]},{"title":"[ARC197D] Ancestor Relation 题解","url":"/2025/ARC197D-Ancestor-Relation-题解/","content":"\n好题啊好题。记 $b_i$ 表示矩阵的第 $i$ 行的内容（用 bitset 维护）。\n\n考虑什么时候有 $a_{u, v} = 1$。因为与孩子有关系的节点一定与祖先有关系，但与祖先有关系的节点不一定与孩子有关系。所以有 $b_u | b_v = b_u$ 或 $b_u | b_v = b_v$，前者对应 $u$ 是 $v$ 的祖先，后者则对应 $v$ 是 $u$ 的祖先。容易证明这是一个充要条件，那么若 $a_{u, v} = 0$，则一定不存在 $b_u | b_v = b_u$ 与 $b_u | b_v = b_v$。\n\n接下来考虑一种特殊情况：$b_u = b_v$，此时 $u, v$ 在一条没有任何分岔的一条“链”上，那么这条链上的节点的位置就可以互换。设一组 $b_i$ 相同的点的数量为 $sz$，那么这一组点可以带来 $sz!$ 的贡献。\n\n此外，$\\forall i \\in [1, n]$，显然需要有 $a_{i, 1} = 1, a_{1, i} = 1$。那么我们就总结出以下三条条件或贡献：\n\n- $\\forall i \\in [1, n], a_{i, 1} = 1, a_{1, i} = 1$。\n- $b_u | b_v = b_u$ 或 $b_u | b_v = b_v$，当且仅当 $a_{u, v} = 1$。（等价于：$a_{u, v} = 1$，当且仅当 $b_u | b_v = b_u$ 或 $b_u | b_v = b_v$。）\n- 对于极多的 $sz$ 个 $b_i$ 相同的数，可以带来 $sz!$ 的贡献。\n\n于是按以上三点计算即可。时间复杂度 $O(\\frac{n^3}{w})$。\n\n[提交记录](https://atcoder.jp/contests/arc197/submissions/65525469)。","tags":["题解"],"categories":["ESSAY"]},{"title":"[ARC196A] Adjacent Delete 题解","url":"/2025/ARC196A-Adjacent-Delete-题解/","content":"\n假设 $n$ 是偶数。如果我们忽略删除相邻数的条件，即可以任选两个数相减，那么答案应该是前 $\\frac{n}{2}$ 大的数（记作“较大数”）的和减去前 $\\frac{n}{2}$ 小的数（记作“较小数”）的和。\n\n容易发现，当我们只能选相邻的数相减时，依然可以达到这个答案，因为在任意时刻，总存在至少一对较大数与较小数相邻。\n\n当 $n$ 是奇数，那么一定有一个元素不被选，且这个元素一定在奇数位，这样才能把数组分成长度为偶数的两段。枚举不被选的位置，用对顶堆维护前后两段的答案即可。\n\n时间复杂度 $O(n \\log n)$。\n\n[提交记录](https://atcoder.jp/contests/arc196/submissions/64670397)","tags":["题解"],"categories":["ESSAY"]},{"title":"[ABC400F] Happy Birthday! 3 题解","url":"/2025/ABC400F-Happy-Birthday-3-题解/","content":"\n考虑正难则反。问题转化为：\n\n> 一个环上有 $n$ 个物品，颜色分别为 $col_i$，每次操作选择两个数 $i, j$ 使得 $\\forall k \\in [i, j],  col_k = col_i \\lor col_k = 0$，将 $[i, j]$ 中的每个物品的颜色都设为 $0$。（下文将这种操作称为“漂白”。）一次操作的代价为 $j - i + 1 + x_{col_i}$。求将整个环漂白的最小总代价。\n  \n先断环为链。设 $dp_{i, j}$ 表示将 $[i, j]$ 漂白的最小代价，那么显然有 $dp_{i, j} = \\min_{k = i}^{j - 1} dp_{i, k} + dp_{k + 1, j}$。\n\n设 $f_{i, j}$ 表示使 $[i, j]$ 能够漂白的最小代价，那么显然有 $f_{i, j} = \\min_{k = 1}^{j - 1} f_{i, k} + dp_{k + 1, j}$。当 $col_i = col_j$ 时，有 $f_{i, j} = \\min (f_{i, j}, f_{i, j - 1}), dp_{i, j} = \\min (dp_{i, j}, f_{i, j} + j - i + x_{col_i})$。\n\n答案即为 $\\min_{i = 1}^n dp_{i, i + n - 1}$。","tags":["题解"],"categories":["ESSAY"]},{"title":"[CF2086E] Zebra-like Numbers 题解","url":"/2025/CF2086E-Zebra-like-Numbers-题解/","content":"\n确简单的啊，可是自己就是想不到。\n\n考虑计算一个数的斑马值。贪心地，尽量选大的斑马数减即可。\n\n考虑 DP，设 $dp_{i, j}$ 表示 $[1, i]$ 中斑马值为 $j$ 的数的个数。那么显然有 $dp_{i, j} = dp_{i - mx, j - 1} + dp_{mx - 1, j}$，其中 $mx$ 是不大于 $i$ 的最大的斑马数。具体地，$dp_{i - mx, j - 1}$ 表示 $[mx, i]$ 中斑马值为 $j$ 的数的个数，$dp_{mx - 1, j}$ 表示 $1, mx - 1$ 中斑马值为 $j$ 的数的个数。\n\n记搜即可。","tags":["题解"],"categories":["ESSAY"]},{"title":"联合省选 2025 游记","url":"/2025/联合省选-2025-游记/","content":"\n**感谢 [@fan_xiaoyi](https://www.luogu.com/user/1495223) 提供的部分文本故事。**\n\n**作者是初二蒟蒻，实力有限，不喜勿喷。**\n\n---\n\n在遥远的**傻子谷**，生长着一棵特殊的树，名为**二叉树**。它以结构规则、枝繁叶茂而闻名，被谷民们视为神树，而神树也庇佑着这片土地。  \n\n二叉树所结的果实被称为**提姆**，其颜色从红到黑，颜色越深，价值越高。此外，还存在一种**灰色提姆**，这类果实尚未成熟，在生长过程中会**随机变化**，无法预测其最终状态。每颗提姆都包含 **100** 颗种子，被称为**芬书**，而谷民们的目标便是收集尽可能多的芬书。  \n\n然而，在**2025**年，由**莲荷绳玄**施加的魔法影响了二叉树，使其结出了**六颗灰色提姆**。这六颗提姆竟化作六只强大的怪物，若想获得这些提姆中的芬书，便必须先战胜这些怪物。  \n\n经过谷民们的推选，我被派往迎战这些怪物，试图夺取属于傻子谷的芬书。据智者**犊子嘚**所言，若能收集到足够的芬书，神树将在**恩欧艾**的力量影响下，再次结出**六颗灰色提姆**，并衍生出新的怪物。然而，我深知自己的能力有限，未必能达成这一目标，因此只希望尽力而为。  \n\n---\n\n第一只怪物名为**幸运数字**，从外观来看，它属于**计数型**怪物，体型庞大，似乎难以应对。我仔细思考后，首先运用**离散化**的方法进行预处理，这一步是必不可少的。随后，我发现该怪物的核心机制是**区间加、单点查询**，于是决定采用**差分**进行优化。最后，在 $O(n \\log n)$ 的时间复杂度内，我成功击败了它，并获得 **100** 颗芬书。  \n\n尽管最终取得了胜利，但由于思考时间过长，我竟花费了**两个半小时**才找到合适的策略，这无疑是一个警示——若不能提高效率，接下来的挑战将更加艰难。  \n\n第二只怪物是**追忆**，它的特性与前者完全不同，更像是一位擅长语言与文学的**文科高手**。这只怪物防御极其严密，正面突破几乎不可能。我尝试以 $O(nq)$ 的方式逐步削弱其防御，并借此消灭了部分附属怪物，最终勉强获得 **20** 颗芬书，但也只能匆匆离开，未能彻底战胜对手。  \n\n第三只怪物名为**图排列**，从它出现的瞬间，我便感受到了一股强大的**压迫感**，甚至无法展开有效的对抗。在尚未理清思路之前，我便被迫撤退，最终一无所获。  \n\n至此，第一天的战斗结束，我一共收集到了 **120** 颗芬书。 \n\n---\n\n第二天的第一只怪物是**推箱子**。面对它时，我迅速想到了解决方案——**线段树维护区间覆盖**。这一策略在理论上可行，然而，我的实现方式时间复杂度为 $O(n \\log^2 n)$，或许并不足以完全击败怪物。尽管如此，我仍尽力施展此计，希望能尽可能多地收集芬书。  \n\n第二只怪物是**岁月**，又是一只**计数**类怪物。它似乎拥有深厚的力量，让人难以撼动。我尝试采用**暴力**方式试图窃取芬书，但也许是**法力不足**，无论如何努力，都未能战胜它。最终，我只能带着遗憾撤退，未能获得任何芬书。  \n\n最后一只怪物是**封印**，依旧是一只**计数**类怪物。由于时间紧迫，我无法深思熟虑，只能匆忙迎战。在激烈的战斗中，我设法获得了**8** 颗芬书，随后便匆匆离开。\n\n最终，我在第二天获得了**大约 100** 颗芬书。  \n\n---\n\n所有的战斗已经结束，我也该带着这**大约 220** 颗芬书回到傻子谷了。而在返回的路途中，我还幸运地捡到了来自**岁月**的 **4** 颗芬书，最终我总共获得了 **232** 个芬书。\n\n**接下来，便又是新一年的征途！**","tags":["游记"],"categories":["ESSAY"]},{"title":"P6808 Candies 题解","url":"/2025/P6808-Candies-题解/","content":"\n### 鲜花\n\n校内模拟赛T3，赛时想到了正解的 $60\\\\%$，所以就得了 $60$ 分……\n\n赛后 T 了若干发之后终于过了。\n\n---\n\n本文提供一种非回退背包的解法。\n\n在下文中，记 $k = \\sum_{i = 1}^n a_i$。\n\n### Solution 1\n\n假设我们修改 $a_i$，设用其他数拼出的方案数为 $cnt_ i$ ，那么当 $a_ i'$ 足够大时，有 ${cnt_ i'}_ {max} = 2cnt_ i + 1$。所以问题就转化到了求 $\\max_ {i = 1}^{n} cnt  _i$ 与 $i$。\n\n考虑枚举 $i$，并对于每个 $i$ 进行 DP 计算 $cnt_i$。求出最大值与最大值位置（即 $p$）后，需要求 $q$。\n\n设 $f_i$ 表示是否能凑出 $i$。很容易发现，当 $\\sum_{i = 1}^k [f_i = 1, f_{i + q} = 1] = 0$ 时，$q$ 合法。暴力枚举即可。\n\n时间复杂度 $O(n ^ 2k + k ^ 2)$，完全不能接受。\n\n### Solution 2\n\n我们发现，在第一种解法中，对于同一个物品，进行了太多次的背包 DP。我们尝试只进行一次DP，**并标记为了凑出当前这个数，有哪些位置必须被选取**。若不需要选取第 $i$ 个数，代表当我们修改 $a_i$ 时仍然能凑出这个数。\n\n具体地，设 $dp_{i, j}$ 表示为了凑出 $i$，是否需要 $a_j$。转移方程如下。\n\n$$$\nf_i = \\mathop{bitor}\\limits_{1\\le k\\le n} f_{i - a_k}\\\\\n\\ \\\\\ndp_{i, j}=\n\\mathop{bitand}\\limits_{1\\le k\\le n,\\ f_{i - a_k} = 1}\n\\begin{cases}\ndp_{i - a_k, j}\\ (j \\ne k)\\\\\n1\\ (j = k)\n\\end{cases}\n$$$\n\nDP 完之后统计 $cnt_i$，剩余步骤与解法一相同。\n\n时间复杂度仍然是 $O(n ^ 2k + k ^ 2)$，但常数好得多，在洛谷上取得了 $60$ 分的好成绩！（这也是我赛时的做法，个人认为特别符合直觉。）\n\n### Solution 3\n\n考虑优化一下求 $q$ 的过程。前文已推得，当 $\\sum_{i = 1}^k [f_i, f_{i + q}] \\ne 0$，$q$ 不合法。设全集（可重集）为 $U$，此时有可重集 $S, T$ 满足 $S, T \\subset U, (\\sum_{i \\in S} b_i) - (\\sum_{i \\in T} b_i) = q$。再正反做一次背包即可。总时间复杂度 $O(n^2k)$，还是卡。\n\n### Solution 4\n\n由于所有状态都是 $0$ 或 $1$，所以可以用 ``bitset`` 优化。最终复杂度 $O(\\frac{n ^ 2k}{w})$，趋近于 $O(nk)$，可以通过。\n\n### Code\n\n在代码中，``dp[i][0]`` 代表文中的 $f_i$，其余的 ``dp[i][j]`` 代表文中的 $dp_{i, j}$。\n\n```cpp\nint n, a[105], sum, cnt[105], mx, p;\nbitset<105> dp[700005];\nbitset<1400005> tmp;\n\nint main() {\n\tread(n);\n\tfor(int i = 1; i <= n; ++i)\n\t\tread(a[i]), sum += a[i];\n\t// 初始化 dp 数组\n\tsort(a + 1, a + 1 + n);\n\tdp[0] = 1, dp[1][0] = 0;\n\tfor(int i = 1; i <= n; ++i)\n\t\tdp[1][i] = 1;\n\tfor(int i = 2; i <= sum; ++i)\n\t\tdp[i] = dp[i - 1];\n\t// 计算 dp 数组\n\tfor(int i = 1; i <= n; ++i)\n\t\tfor(int j = sum; j >= a[i]; --j)\n\t\t\tif(dp[j - a[i]][0]) {\n\t\t\t\tdp[j] &= dp[j - a[i]];\n\t\t\t\tif(!dp[j][0]) dp[j][i] = 1;\n\t\t\t\tdp[j][0] = 1;\n\t\t\t}\n\t// 统计 cnt 并计算 p\n\tfor(int i = 1; i <= sum; ++i)\n\t\tif(dp[i][0])\n\t\t\tfor(int j = 1; j <= n; ++j)\n\t\t\t\tif(!dp[i][j])\n\t\t\t\t\t++cnt[j];\n\tmx = p = 0;\n\tfor(int i = 1; i <= n; ++i)\n\t\tif(cnt[i] > mx) mx = cnt[i], p = i;\n\t// 计算 q\n\ttmp[7000 * n] = 1;\n\tfor(int i = 1; i <= n; ++i)\n\t\tif(i != p)\n\t\t\ttmp = tmp | (tmp << a[i]) | (tmp >> a[i]);\n\tfor(int i = 1; i <= sum - a[p] + 1; ++i)\n\t\tif(!tmp[7000 * n + i])\n\t\t\treturn printf(\"%d %d\\n\", a[p], i), 0;\n}\n```\n\n这代码截止发题解当天竟然还跑出了[洛谷最优解](https://www.luogu.com.cn/record/200199228)。（不过做这道题的人少。）","tags":["题解"],"categories":["ESSAY"]},{"title":"NOIP + 游记（流水帐）","url":"/2024/NOIP-游记/","content":"\n### 为什么是NOIP + 游记？\n\n因为其实是 ``NOIP游记`` 和 ``环球中心游记`` 。\n\n### Warning\n\n本文纯流水帐，想了解题目做法的请移步。\n\n### Day -34\n\n考 ``CSP-S`` 了，炸掉了。赛时估分只有120-160pts。\n\n### Day -26\n\n出分了，170pts。\n\n### Day -11\n\n出分数线了，SC180pts呜呜呜。\n\n### Day -??\n\n老师给我们报了NOIP。\n\n### Day -??\n\nNOIP线出来了，165pts，好险。\n\n### Day 0\n\n#### 7：50\n\n到嘉祥锦江了。\n\n#### 8：00\n\n在机房门口和同学们玩了一会儿，还上了个厕所（嘉祥的卫生间竟然有坐便。但是，很难评。。。）。\n\n#### 8：20\n\n发现我的键盘空格键回弹不好，找老师换了一个。\n\n#### 8：30\n\n开考了。大概看了一下题，第一眼T2、T3计数，感觉不可做；T1贪心，感觉可做；T4数据结构应该能骗点分。开写T1。\n\n#### 10：45\n\n由于本蒟贪心不好，再加上本来太菜了，T1花了约2.25h（其实中间也有摸鱼）才过大样例。做法：找两个字符串在“连通块”内0和1的个数，再尽量去匹配。又把剩下的题看了一遍，感觉T2是数学题，可做。开写T2。\n\n#### ??：??\n\n写了一下 $m = 1$ 和特殊性质A，预估35pts。这两个性质是很容易推出式子来的。\n\n#### 12：30\n\n边摸鱼边写迷惑行为边推式子，T2最后蒙猜凑测量斗过大样例了。做法：数学，推式子，这里不（想）详细展开。没时间写其它题了。开颓。\n\n#### 13：00\n\n考完了。赛时预估200pts。\n\n#### Summary\n\n本初中蒟蒻第一次打NOIP，还是太蒟了，主要在摸鱼或罚坐（还有写迷惑行为），不过感觉发挥比CSP-S要好。\n\n#### 13：10\n\n出考场，和家长、同学沟通，准备找个地方一起玩。最后选择去了[JDScript0117](https://www.luogu.com.cn/user/910593)家附近的环球中心。另外还有[hard_plan](https://www.luogu.com.cn/user/749406)和[HD0X](https://www.luogu.com.cn/user/545470)。\n\n路上浅浅讨论了一下。[hard_plan](https://www.luogu.com.cn/user/749406)说了一个关于T4LCA的trick，但是就算我赛时知道这个trick我也做不来（因为我现在还是做不来）。\n\n#### 13：??\n\n到环球中心了。吃的~和~麦~府~当~捞~劳~面~。它的薯~面~条都是用土豆做的！\n\n#### 14：??-15：??\n\n吃完了。不知道玩什么。先去喜茶坐着了。考虑剧本杀或桌游之类，最后说去买扑克牌，结果我妈让我16：00就要走，没买扑克牌。无语了。\n\n#### 15：40\n\n喜茶太多人了，到星巴克一人点了一杯拿铁。\n\n#### 16：00\n\n我走了，其他人说是去旁边公园骑车了。\n\n#### 17：00\n\n[JDScript0117](https://www.luogu.com.cn/user/910593)给我打电话让我立即马上随便发两条朋友圈，原来他们没有骑车，在公园里晒太阳、玩真心话大冒险。我本来以为他们这些大朋友不像我这个小朋友一样喜欢玩真心话大冒险，所以最开始就没提出来，最后一下午啥也没干。烦。\n\n#### 17：10\n\n重新写了T2的代码，洛谷上民间~故事~数据A了（民间故事->folklore）。\n\n#### 18：00\n\n[yishu2(教练)](https://www.luogu.com.cn/user/17126)说第一题是DP，有坑，贪心可能会挂一些。看运气吧。\n\n### Day 1\n\n洛谷上四道题的民间数据已经陆续在出了，中午测了T1，过了。最终自测200pts，希望不要写挂。看了一下去年的题和分数线，洛谷上给的难度是今年严格不小于去年，去年SC一等线200pts，今年就看运气了。\n\n### Day 2 - 6\n\n_Day 6 : 12月6日_\n\n这几天中间不定时地交民间数据（因为害怕数据更改被卡掉，不过事实上并没有），Waiting。\n\n### Day 7\n\n今天早上准备去高中的时候恰好碰到``LCY``，他说出分了。啊？不是12月9日才出分吗？（而且12月9日是我的生日。）结果提前了？这就是住校生的缺点——信息闭塞。于是赶紧跑到机房，查分——爽！没挂！200pts。\n\n虽然说啊，我还是够蒟的，但是该拿的分还是拿到了，还是比较开心。\n\n达成成就： $\\mathrm{S} \\lt \\mathrm{NOIP}$ 。","tags":["游记"],"categories":["ESSAY"]},{"title":"[ARC050C] LCM 111 题解","url":"/2024/ARC050C-LCM-111-题解/","content":"\n## 一句话题解\n\n转化两个大数的 $\\gcd$，再用倍增求答案。\n\n## 题意\n\n[题目](https://www.luogu.com.cn/problem/AT_arc050_c)  \n\n给你 $a, b, m$，其中 $1 \\leq a, b \\leq 10^{18}, 2 \\leq m \\leq 10^9$，让你求 $a$ 个 $1$ 拼接起来的数和 $b$ 个 $1$ 拼接起来的数的最小公倍数。\n\n## 思路\n\n我们构造一个函数 $\\mathrm{one}(x)$ 表示 $x$ 个 $1$ 拼接起来，用数学语言表述就是：  \n\n$$\n\\mathrm{one}(x) = \\frac{10^x - 1}{9}\n$$  \n\n同时又有 $\\mathrm{lcm}(a, b) = a \\cdot b \\div \\gcd(a, b)$，那么我们要求的就转化成了：  \n\n$$\n\\mathrm{one}(a) \\cdot \\mathrm{one}(b) \\div \\gcd(\\mathrm{one}(a), \\mathrm{one}(b))\n$$  \n\n因为 $\\mathrm{one}(a)$ 与 $\\mathrm{one}(b)$ 都比较好求，所以此时的问题就转移到了怎么求 $\\gcd(\\mathrm{one}(a), \\mathrm{one}(b))$ 上来。\n\n我们尝试感性理解一下。可以发现：  \n\n$$\n\\gcd(\\mathrm{one}(a), \\mathrm{one}(b)) = \\mathrm{one}(\\gcd(a, b))\n$$  \n\n此时答案就变成了：  \n\n$$\n\\mathrm{one}(a) \\cdot \\mathrm{one}(b) \\div \\mathrm{one}(\\gcd(a, b))\n$$  \n\n我们把这个式子分成两组：  \n\n$$\n\\mathrm{one}(a)\n\\\\\n\\mathrm{one}(b) \\div \\mathrm{one}(\\gcd(a, b))\n$$  \n\n对于每一组单独用倍增计算即可。详见代码。  \n\n[提交记录 | 快得飞起](https://atcoder.jp/contests/arc050/submissions/57132805)  \n\n## AC Code\n\n```cpp\n#include <bits/stdc++.h>\n#define int long long\nusing namespace std;\nint a, b, p, d;\n\nint gcd(int a, int b) {\n    if (b == 0) return a;\n    return gcd(b, a % b);\n}\n\nint qpow(int x, int y) { // 快速幂\n    int ans = 1;\n    while (y) {\n        if (y & 1) ans = (ans * x) % p;\n        y >>= 1;\n        x = (x * x) % p;\n    }\n    return ans;\n}\n\nint cal(int x, int y) { // 倍增计算答案\n    int now = 1, npow = qpow(10, y), ans = 0;\n    while (x) {\n        if (x & 1) ans = ((ans * npow) % p + now) % p;\n        x >>= 1;\n        now = ((now * npow) % p + now) % p;\n        npow = (npow * npow) % p;\n    }\n    return ans;\n}\n\nvoid solve() {\n    cin >> a >> b >> p;\n    d = gcd(a, b);\n    cout << cal(a, 1) * cal(b / d, d) % p << endl; // 对于第二组，gcd(a, b) 是一个循环节，一共有 b / gcd(a, b) 个循环。\n    return;\n}\n\nsigned main() {\n    cin.tie(0);\n    cout.tie(0);\n    int T = 1;\n    while (T--) solve();\n    return 0;\n}\n```\n\n## 最后\n\n问我为什么不推式子？如果你直接开始推式子，你会推出一个带分母的式子。有分母就要求逆元，但是本题中并未保证模数的性质，所以不能直接求逆元。","tags":["题解"],"categories":["ESSAY"]},{"title":"[COCI 2023/2024 #2] Zatopljenje 题解","url":"/2024/COCI-2023-2024-2-Zatopljenje-题解/","content":"\n### 闲话\n\n考前集训，每日一练做到的题，~我写挂了五次~。自己想到**分块**的做法，看题解区没有，于是来发一篇。\n\n### 思路\n\n我们注意到，当海水高度为 $x$ 时，区间 $[l, r]$ 的小岛的个数可以这么计算：\n\n$$\n[h_l \\gt x] + \\sum_{i = l}^{r - 1}[h_i \\le x \\lt h_{i + 1}]\n$$\n\n所以第 $i$ 个位置产生贡献**当且仅当** $h_i \\le x \\lt h_{i + 1}$ ，考虑分块并预处理出每个块的答案。由于 $0 \\le h_i, x_i \\le 10^9$ ，所以要**离散化**。时间复杂度 $O((n + q)(\\sqrt{n} + \\log{n}))$ ，虽然比不上线段树或树状数组，但是思路还是比较好想的。\n\n具体细节见代码实现。\n\n**Tip : 不要开``long long``，不然会MLE。**\n\n### Code\n\n```cpp\n#include <bits/stdc++.h>\n#define PII pair<int, int>\nusing namespace std;\ntemplate <typename _Tp>\ninline void read(_Tp &x) {\n\tint neg = 1;\n\tchar ch;\n\twhile(ch = getchar(), !isdigit(ch)) if(ch == '-') neg = -1;\n\tx = ch - '0';\n\twhile(ch = getchar(), isdigit(ch)) x = (x << 3) + (x << 1) + (ch ^ '0');\n\tx *= neg;\n\treturn;\n}\n// bans[i][j] : 第 i 个块当 x = j 时的答案\nint n, q, a[200005], blk, cnt, bans[505][200005], x, l, r;\nPII p[200005];\nsigned main() {\n\tread(n), read(q);\n\tfor(int i = 1; i <= n; ++i) read(a[i]);\n\t// 加一个 0 ，方便离散化\n\ta[0] = 0, ++n;\n\t// 离散化\n\tfor(int i = 0; i < n; ++i) p[i] = {a[i], i};\n\tsort(p, p + n);\n\tfor(int i = 0; i < n; ++i) {\n\t\tif(i == 0) a[p[i].second] = 1;\n\t\telse {\n\t\t\tif(p[i].first == p[i - 1].first) a[p[i].second] = a[p[i - 1].second];\n\t\t\telse a[p[i].second] = a[p[i - 1].second] + 1;\n\t\t}\n\t}\n\t// 分块\n\tblk = sqrt(n);\n\tcnt = (n - 1) / blk + 1;\n\tfor(int i = 0; i < n - 1; ++i) if(a[i] < a[i + 1]) {\n\t\t\t// 差分计算答案\n\t\t\t++bans[i / blk][a[i]];\n\t\t\t--bans[i / blk][a[i + 1]];\n\t\t}\n\t// 前缀和\n\tfor(int i = 0; i < cnt; ++i) for(int j = 1; j <= n; ++j) bans[i][j] += bans[i][j - 1];\n\twhile(q--) {\n\t\tread(l), read(r), read(x);\n\t\t// 对 x 离散化，找到最后一个小于等于 x 的值\n\t\tint ind = lower_bound(p, p + n, (PII){x + 1, 0}) - p, ans;\n\t\tx = a[p[ind - 1].second];\n\t\t// l 点的答案\n\t\tans = a[l] > x;\n\t\tif(l / blk == r / blk) {\n\t\t\t// 在同一个块中\n\t\t\tfor(int i = l; i < r; ++i) ans += (a[i] <= x && a[i + 1] > x);\n\t\t}\n\t\telse {\n\t\t\t// 计算 l 所在块的答案\n\t\t\tfor(int i = l; i < (l / blk + 1) * blk; ++i) ans += (a[i] <= x && a[i + 1] > x);\n\t\t\t// 计算 r 所在块的答案\n\t\t\tfor(int i = r / blk * blk; i < r; ++i) ans += (a[i] <= x && a[i + 1] > x);\n\t\t\t// 计算中间块的答案\n\t\t\tfor(int i = l / blk + 1; i < r / blk; ++i)ans += bans[i][x];\n\t\t}\n\t\tprintf(\"%lld\\n\", ans);\n\t}\n\treturn 0;\n}\n```\n\n[Submisson](https://www.luogu.com.cn/record/183250736)\n\n---\n\n**完结撒花！！！✿✿ヽ(°▽°)ノ✿**","tags":["题解"],"categories":["ESSAY"]},{"title":"关于","url":"/about/index.html","content":"\n初二，坐标 SC，现役 OIer。\n\n![](https://api.jerryz.com.cn/about?id=725640)\n\n![](https://atrating.baoshuo.dev/rating?username=Getaway_Car)\n\n![](https://cfrating.baoshuo.dev/rating?username=Getaway_Car)"},{"url":"/search/index.html"},{"title":"友情链接","url":"/friends/index.html","content":"\n[IGpig's Blog](https://kalipig.github.io/)"},{"url":"/categories/index.html"},{"url":"/tags/index.html"},{"title":"开源项目","url":"/projects/index.html","content":"\n# 码卡\n\n_英文名：ByteBlitz_\n\n一款富含 OI（信息学奥赛）元素的卡牌游戏，目前处于开发阶段。\n\n如果你想加入，请在仓库中提issue或发邮件到``heyicong.jeremy@gmail.com``。\n\n仓库地址：[ByteBlitz](https://github.com/GetawayCar1024/ByteBlitz)\n\n# 事件捕捉\n\n_英文名：EventCapture_\n\n用于捕捉事件并作出反应的模块。\n\n本模块将被用于码卡。\n\n仓库地址：[EventCapture](https://github.com/GetawayCar1024/EventCapture)"}]